<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>slickR with Iframes â€¢ slickR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="slickR with Iframes">
<meta property="og:description" content="slickR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">slickR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/metrumresearchgroup/slickR">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="http://twitter.com/MetrumRG">
    <span class="fa fa-lg fa-twitter"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="iframes_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="iframes_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="iframes_files/anchor-sections-1.0/anchor-sections.js"></script><script src="iframes_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="iframes_files/jquery-3.4.1/jquery-3.4.1.min.js"></script><script src="iframes_files/jquery-migrate-3.1.0/jquery-migrate-3.1.0.min.js"></script><link href="iframes_files/slick-1.8.1/slick/slick.css" rel="stylesheet">
<link href="iframes_files/slick-1.8.1/slick/slick-theme.css" rel="stylesheet">
<script src="iframes_files/slick-1.8.1/slick/slick.min.js"></script><script src="iframes_files/css-resize-1.2.1/ResizeSensor.js"></script><script src="iframes_files/css-resize-1.2.1/ElementQueries.js"></script><link href="iframes_files/slickR-0.0.1/slick.css" rel="stylesheet">
<link href="iframes_files/slickR-0.0.1/slick-theme.css" rel="stylesheet">
<script src="iframes_files/slickR-0.0.1/slickR.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>slickR with Iframes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/yonicd/slickR/blob/master/vignettes/iframes.Rmd"><code>vignettes/iframes.Rmd</code></a></small>
      <div class="hidden name"><code>iframes.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yonicd/slickR">slickR</a></span><span class="op">)</span></code></pre></div>
<div id="iframes" class="section level2">
<h2 class="hasAnchor">
<a href="#iframes" class="anchor"></a>Iframes</h2>
<p>Since the carousel can accept any html element we can place iframes in the carousel.</p>
<p>There are times when you may want to put in different DOMs rather than an image in slick.</p>
<p>Using <code>slideType</code> you can specify which DOM is used in the slides.</p>
<p>For example lets put the help Rd files from ggplot2 into a slider using the helper function <code>getHelp</code>.</p>
<p><strong>Dont forget to open the output to a browser to view the iframe contents</strong></p>
<div id="function-to-fetch-help-files-as-html" class="section level3">
<h3 class="hasAnchor">
<a href="#function-to-fetch-help-files-as-html" class="anchor"></a>Function to fetch help files as HTML</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">get_help</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">fn</span>,<span class="va">pkg</span><span class="op">)</span><span class="op">{</span>
 
  <span class="va">ff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">'index.search'</span>,envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-internal.html">asNamespace</a></span><span class="op">(</span><span class="st">'utils'</span><span class="op">)</span><span class="op">)</span><span class="op">(</span>
    topic <span class="op">=</span> <span class="va">fn</span>, 
    paths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/find.package.html">find.package</a></span><span class="op">(</span><span class="va">pkg</span><span class="op">)</span>,
    <span class="cn">TRUE</span><span class="op">)</span>
  
  <span class="va">path</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="va">ff</span><span class="op">)</span>
  <span class="va">dirpath</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">dirname</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span>
  <span class="va">pkgname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">dirpath</span><span class="op">)</span>
  <span class="va">RdDB</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="va">pkgname</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
    <span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html">capture.output</a></span><span class="op">(</span><span class="op">{</span>
      <span class="fu">tools</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/tools/Rd2HTML.html">Rd2HTML</a></span><span class="op">(</span>
        Rd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">'fetchRdDB'</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-internal.html">asNamespace</a></span><span class="op">(</span><span class="st">'tools'</span><span class="op">)</span><span class="op">)</span><span class="op">(</span><span class="va">RdDB</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html">basename</a></span><span class="op">(</span><span class="va">ff</span><span class="op">)</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>,
  collapse<span class="op">=</span><span class="st">'\n'</span><span class="op">)</span>
  
<span class="op">}</span></code></pre></div>
</div>
<div id="retrieve-help-from-stats" class="section level3">
<h3 class="hasAnchor">
<a href="#retrieve-help-from-stats" class="anchor"></a>Retrieve help from <code>stats</code>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">help_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="st">"package:stats"</span>,pattern <span class="op">=</span> <span class="st">'^r'</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,
    <span class="va">get_help</span>,
    pkg <span class="op">=</span> <span class="st">'stats'</span><span class="op">)</span></code></pre></div>
</div>
<div id="create-iframe-slick" class="section level3">
<h3 class="hasAnchor">
<a href="#create-iframe-slick" class="anchor"></a>Create IFRAME slick</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">slickR</span><span class="fu">::</span><span class="fu"><a href="../reference/slickR.html">slickR</a></span><span class="op">(</span><span class="va">help_files</span>,
               slideType <span class="op">=</span> <span class="st">'iframe'</span>,
               height <span class="op">=</span> <span class="fl">400</span>,
               width<span class="op">=</span><span class="st">'95%'</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="../reference/settings.html">settings</a></span><span class="op">(</span>dots  <span class="op">=</span> <span class="cn">TRUE</span>, 
           slidesToShow   <span class="op">=</span> <span class="fl">2</span>, 
           slidesToScroll <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-896d1c5033531b46ffe0" style="width:95%;height:432.632880098888px;" class="slickR html-widget"></div>
<script type="application/json" data-for="htmlwidget-896d1c5033531b46ffe0">{"x":[{"obj":"<div class=\"baseDiv_bump_41934891557321\">\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Beta Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Beta&quot;&gt;&lt;tr&gt;&lt;td&gt;Beta&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Beta Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the Beta distribution with parameters &lt;code&gt;shape1&lt;/code&gt; and&#10;&lt;code&gt;shape2&lt;/code&gt; (and optional non-centrality parameter &lt;code&gt;ncp&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dbeta(x, shape1, shape2, ncp = 0, log = FALSE)&#10;pbeta(q, shape1, shape2, ncp = 0, lower.tail = TRUE, log.p = FALSE)&#10;qbeta(p, shape1, shape2, ncp = 0, lower.tail = TRUE, log.p = FALSE)&#10;rbeta(n, shape1, shape2, ncp = 0)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;shape1, shape2&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;non-negative parameters of the Beta distribution.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;ncp&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;non-centrality parameter.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The Beta distribution with parameters &lt;code&gt;shape1&lt;/code&gt; &lt;i&gt;= a&lt;/i&gt; and&#10;&lt;code&gt;shape2&lt;/code&gt; &lt;i&gt;= b&lt;/i&gt; has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;&amp;Gamma;(a+b)/(&amp;Gamma;(a)&amp;Gamma;(b))x^(a-1)(1-x)^(b-1)&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;a &amp;gt; 0&lt;/i&gt;, &lt;i&gt;b &amp;gt; 0&lt;/i&gt; and &lt;i&gt;0 &amp;le; x &amp;le; 1&lt;/i&gt;&#10;where the boundary values at &lt;i&gt;x=0&lt;/i&gt; or &lt;i&gt;x=1&lt;/i&gt; are defined as&#10;by continuity (as limits).&#10;&lt;br /&gt;&#10;The mean is &lt;i&gt;a/(a+b)&lt;/i&gt; and the variance is &lt;i&gt;ab/((a+b)^2 (a+b+1))&lt;/i&gt;.&#10;These moments and all distributional properties can be defined as&#10;limits (leading to point masses at 0, 1/2, or 1) when &lt;i&gt;a&lt;/i&gt; or&#10;&lt;i&gt;b&lt;/i&gt; are zero or infinite, and the corresponding&#10;&lt;code&gt;[dpqr]beta()&lt;/code&gt; functions are defined correspondingly.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;pbeta&lt;/code&gt; is closely related to the incomplete beta function.  As&#10;defined by Abramowitz and Stegun 6.6.1&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;B_x(a,b) =&#10;    integral_0^x t^(a-1) (1-t)^(b-1) dt,&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;and 6.6.2 &lt;i&gt;I_x(a,b) = B_x(a,b) / B(a,b)&lt;/i&gt; where&#10;&lt;i&gt;B(a,b) = B_1(a,b)&lt;/i&gt; is the Beta function (&lt;code&gt;beta&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;i&gt;I_x(a,b)&lt;/i&gt; is &lt;code&gt;pbeta(x, a, b)&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The noncentral Beta distribution (with &lt;code&gt;ncp&lt;/code&gt; &lt;i&gt; = &amp;lambda;&lt;/i&gt;)&#10;is defined (Johnson &lt;em&gt;et al&lt;/em&gt;, 1995, pp. 502) as the distribution of&#10;&lt;i&gt;X/(X+Y)&lt;/i&gt; where &lt;i&gt;X ~ chi^2_2a(&amp;lambda;)&lt;/i&gt;&#10;and &lt;i&gt;Y ~ chi^2_2b&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dbeta&lt;/code&gt; gives the density, &lt;code&gt;pbeta&lt;/code&gt; the distribution&#10;function, &lt;code&gt;qbeta&lt;/code&gt; the quantile function, and &lt;code&gt;rbeta&lt;/code&gt;&#10;generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid arguments will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rbeta&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;Supplying &lt;code&gt;ncp = 0&lt;/code&gt; uses the algorithm for the non-central&#10;distribution, which is not the same algorithm as when &lt;code&gt;ncp&lt;/code&gt; is&#10;omitted.  This is to give consistent behaviour in extreme cases with&#10;values of &lt;code&gt;ncp&lt;/code&gt; very near zero.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&#10;&lt;ul&gt;&#10;&lt;li&gt;&lt;p&gt; The central &lt;code&gt;dbeta&lt;/code&gt; is based on a binomial probability, using code&#10;contributed by Catherine Loader (see &lt;code&gt;dbinom&lt;/code&gt;) if either&#10;shape parameter is larger than one, otherwise directly from the definition.&#10;The non-central case is based on the derivation as a Poisson&#10;mixture of betas (Johnson &lt;em&gt;et al&lt;/em&gt;, 1995, pp. 502&amp;ndash;3).&#10;&lt;/p&gt;&#10;&lt;/li&gt;&#10;&lt;li&gt;&lt;p&gt; The central &lt;code&gt;pbeta&lt;/code&gt; for the default (&lt;code&gt;log_p = FALSE&lt;/code&gt;)&#10;uses a C translation based on&#10;&lt;/p&gt;&#10;&lt;p&gt;Didonato, A. and Morris, A., Jr, (1992)&#10;Algorithm 708: Significant digit computation of the incomplete beta&#10;function ratios,&#10;&lt;em&gt;ACM Transactions on Mathematical Software&lt;/em&gt;, &lt;b&gt;18&lt;/b&gt;, 360&amp;ndash;373.&#10;(See also&lt;br /&gt;&#10;Brown, B. and Lawrence Levy, L. (1994)&#10;Certification of algorithm 708: Significant digit computation of the&#10;incomplete beta,&#10;&lt;em&gt;ACM Transactions on Mathematical Software&lt;/em&gt;, &lt;b&gt;20&lt;/b&gt;, 393&amp;ndash;397.)&#10;&lt;br /&gt; &#10;We have slightly tweaked the original &amp;ldquo;TOMS 708&amp;rdquo; algorithm, and&#10;enhanced for &lt;code&gt;log.p = TRUE&lt;/code&gt;.  For that (log-scale) case,&#10;underflow to &lt;code&gt;-Inf&lt;/code&gt; (i.e., &lt;i&gt;P = 0&lt;/i&gt;) or &lt;code&gt;0&lt;/code&gt;, (i.e.,&#10;&lt;i&gt;P = 1&lt;/i&gt;) still happens because the original algorithm was designed&#10;without log-scale considerations.  Underflow to &lt;code&gt;-Inf&lt;/code&gt; now&#10;typically signals a &lt;code&gt;warning&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;/li&gt;&#10;&lt;li&gt;&lt;p&gt; The non-central &lt;code&gt;pbeta&lt;/code&gt; uses a C translation of&#10;&lt;/p&gt;&#10;&lt;p&gt;Lenth, R. V. (1987) Algorithm AS 226: Computing noncentral beta&#10;probabilities. &lt;em&gt;Appl. Statist&lt;/em&gt;, &lt;b&gt;36&lt;/b&gt;, 241&amp;ndash;244,&#10;incorporating&lt;br /&gt;&#10;Frick, H. (1990)&#39;s AS R84, &lt;em&gt;Appl. Statist&lt;/em&gt;, &lt;b&gt;39&lt;/b&gt;, 311&amp;ndash;2,&#10;and&lt;br /&gt;&#10;Lam, M.L. (1995)&#39;s AS R95, &lt;em&gt;Appl. Statist&lt;/em&gt;, &lt;b&gt;44&lt;/b&gt;, 551&amp;ndash;2.&#10;&lt;/p&gt;&#10;&lt;p&gt;This computes the lower tail only, so the upper tail suffers from&#10;cancellation and a warning will be given when this is likely to be&#10;significant.&#10;&lt;/p&gt;&#10;&lt;/li&gt;&#10;&lt;li&gt;&lt;p&gt; The central case of &lt;code&gt;qbeta&lt;/code&gt; is based on a C translation of&#10;&lt;/p&gt;&#10;&lt;p&gt;Cran, G. W., K. J. Martin and G. E. Thomas (1977).&#10;Remark AS R19 and Algorithm AS 109,&#10;&lt;em&gt;Applied Statistics&lt;/em&gt;,  &lt;b&gt;26&lt;/b&gt;, 111&amp;ndash;114,&#10;and subsequent remarks (AS83 and correction).&#10;&lt;/p&gt;&#10;&lt;/li&gt;&#10;&lt;li&gt;&lt;p&gt;  The central case of &lt;code&gt;rbeta&lt;/code&gt; is based on a C translation of&#10;&lt;/p&gt;&#10;&lt;p&gt;R. C. H. Cheng (1978).&#10;Generating beta variates with nonintegral shape parameters.&#10;&lt;em&gt;Communications of the ACM&lt;/em&gt;, &lt;b&gt;21&lt;/b&gt;, 317&amp;ndash;322.&#10;&lt;/p&gt;&#10;&lt;/li&gt;&lt;/ul&gt;&#10;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Abramowitz, M. and Stegun, I. A. (1972)&#10;&lt;em&gt;Handbook of Mathematical Functions.&lt;/em&gt; New York: Dover.&#10;Chapter 6: Gamma and Related Functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 2, especially&#10;chapter 25. Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;beta&lt;/code&gt; for the Beta function.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;x &amp;lt;- seq(0, 1, length = 21)&#10;dbeta(x, 1, 1)&#10;pbeta(x, 1, 1)&#10;&#10;## Visualization, including limit cases:&#10;pl.beta &amp;lt;- function(a,b, asp = if(isLim) 1, ylim = if(isLim) c(0,1.1)) {&#10;  if(isLim &amp;lt;- a == 0 || b == 0 || a == Inf || b == Inf) {&#10;    eps &amp;lt;- 1e-10&#10;    x &amp;lt;- c(0, eps, (1:7)/16, 1/2+c(-eps,0,eps), (9:15)/16, 1-eps, 1)&#10;  } else {&#10;    x &amp;lt;- seq(0, 1, length = 1025)&#10;  }&#10;  fx &amp;lt;- cbind(dbeta(x, a,b), pbeta(x, a,b), qbeta(x, a,b))&#10;  f &amp;lt;- fx; f[fx == Inf] &amp;lt;- 1e100&#10;  matplot(x, f, ylab=&quot;&quot;, type=&quot;l&quot;, ylim=ylim, asp=asp,&#10;          main = sprintf(&quot;[dpq]beta(x, a=%g, b=%g)&quot;, a,b))&#10;  abline(0,1,     col=&quot;gray&quot;, lty=3)&#10;  abline(h = 0:1, col=&quot;gray&quot;, lty=3)&#10;  legend(&quot;top&quot;, paste0(c(&quot;d&quot;,&quot;p&quot;,&quot;q&quot;), &quot;beta(x, a,b)&quot;),&#10;         col=1:3, lty=1:3, bty = &quot;n&quot;)&#10;  invisible(cbind(x, fx))&#10;}&#10;pl.beta(3,1)&#10;&#10;pl.beta(2, 4)&#10;pl.beta(3, 7)&#10;pl.beta(3, 7, asp=1)&#10;&#10;pl.beta(0, 0)   ## point masses at  {0, 1}&#10;&#10;pl.beta(0, 2)   ## point mass at 0 ; the same as&#10;pl.beta(1, Inf)&#10;&#10;pl.beta(Inf, 2) ## point mass at 1 ; the same as&#10;pl.beta(3, 0)&#10;&#10;pl.beta(Inf, Inf)# point mass at 1/2&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Binomial Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Binomial&quot;&gt;&lt;tr&gt;&lt;td&gt;Binomial&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Binomial Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the binomial distribution with parameters &lt;code&gt;size&lt;/code&gt;&#10;and &lt;code&gt;prob&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;This is conventionally interpreted as the number of &amp;lsquo;successes&amp;rsquo;&#10;in &lt;code&gt;size&lt;/code&gt; trials.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dbinom(x, size, prob, log = FALSE)&#10;pbinom(q, size, prob, lower.tail = TRUE, log.p = FALSE)&#10;qbinom(p, size, prob, lower.tail = TRUE, log.p = FALSE)&#10;rbinom(n, size, prob)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;size&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of trials (zero or more).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;prob&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;probability of success on each trial.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The binomial distribution with &lt;code&gt;size&lt;/code&gt; &lt;i&gt;= n&lt;/i&gt; and&#10;&lt;code&gt;prob&lt;/code&gt; &lt;i&gt;= p&lt;/i&gt; has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;&#10;    p(x) = choose(n, x) p^x (1-p)^(n-x)&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x = 0, &amp;hellip;, n&lt;/i&gt;.&#10;Note that binomial &lt;em&gt;coefficients&lt;/em&gt; can be computed by&#10;&lt;code&gt;choose&lt;/code&gt; in &lt;span style=&quot;font-family: Courier New, Courier; color: #666666;&quot;&gt;&lt;b&gt;R&lt;/b&gt;&lt;/span&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;If an element of &lt;code&gt;x&lt;/code&gt; is not integer, the result of &lt;code&gt;dbinom&lt;/code&gt;&#10;is zero, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;i&gt;p(x)&lt;/i&gt; is computed using Loader&#39;s algorithm, see the reference below.&#10;&lt;/p&gt;&#10;&lt;p&gt;The quantile is defined as the smallest value &lt;i&gt;x&lt;/i&gt; such that&#10;&lt;i&gt;F(x) &amp;ge; p&lt;/i&gt;, where &lt;i&gt;F&lt;/i&gt; is the distribution function.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dbinom&lt;/code&gt; gives the density, &lt;code&gt;pbinom&lt;/code&gt; gives the distribution&#10;function, &lt;code&gt;qbinom&lt;/code&gt; gives the quantile function and &lt;code&gt;rbinom&lt;/code&gt;&#10;generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;If &lt;code&gt;size&lt;/code&gt; is not an integer, &lt;code&gt;NaN&lt;/code&gt; is returned.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rbinom&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;For &lt;code&gt;dbinom&lt;/code&gt; a saddle-point expansion is used: see&#10;&lt;/p&gt;&#10;&lt;p&gt;Catherine Loader (2000). &lt;em&gt;Fast and Accurate Computation of&#10;Binomial Probabilities&lt;/em&gt;; available as&#10;&lt;a href=&quot;https://www.r-project.org/doc/reports/CLoader-dbinom-2002.pdf&quot;&gt;https://www.r-project.org/doc/reports/CLoader-dbinom-2002.pdf&lt;/a&gt;&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;pbinom&lt;/code&gt; uses &lt;code&gt;pbeta&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;qbinom&lt;/code&gt; uses the Cornish&amp;ndash;Fisher Expansion to include a skewness&#10;correction to a normal approximation, followed by a search.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rbinom&lt;/code&gt; (for &lt;code&gt;size &amp;lt; .Machine$integer.max&lt;/code&gt;) is based on&#10;&lt;/p&gt;&#10;&lt;p&gt;Kachitvichyanukul, V. and Schmeiser, B. W. (1988)&#10;Binomial random variate generation.&#10;&lt;em&gt;Communications of the ACM&lt;/em&gt;, &lt;b&gt;31&lt;/b&gt;, 216&amp;ndash;222.&#10;&lt;/p&gt;&#10;&lt;p&gt;For larger values it uses inversion.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dnbinom&lt;/code&gt; for the negative binomial, and&#10;&lt;code&gt;dpois&lt;/code&gt; for the Poisson distribution.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;# Compute P(45 &amp;lt; X &amp;lt; 55) for X Binomial(100,0.5)&#10;sum(dbinom(46:54, 100, 0.5))&#10;&#10;## Using &quot;log = TRUE&quot; for an extended range :&#10;n &amp;lt;- 2000&#10;k &amp;lt;- seq(0, n, by = 20)&#10;plot (k, dbinom(k, n, pi/10, log = TRUE), type = &quot;l&quot;, ylab = &quot;log density&quot;,&#10;      main = &quot;dbinom(*, log=TRUE) is better than  log(dbinom(*))&quot;)&#10;lines(k, log(dbinom(k, n, pi/10)), col = &quot;red&quot;, lwd = 2)&#10;## extreme points are omitted since dbinom gives 0.&#10;mtext(&quot;dbinom(k, log=TRUE)&quot;, adj = 0)&#10;mtext(&quot;extended range&quot;, adj = 0, line = -1, font = 4)&#10;mtext(&quot;log(dbinom(k))&quot;, col = &quot;red&quot;, adj = 1)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Cauchy Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Cauchy&quot;&gt;&lt;tr&gt;&lt;td&gt;Cauchy&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Cauchy Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the Cauchy distribution with location parameter&#10;&lt;code&gt;location&lt;/code&gt; and scale parameter &lt;code&gt;scale&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dcauchy(x, location = 0, scale = 1, log = FALSE)&#10;pcauchy(q, location = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)&#10;qcauchy(p, location = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)&#10;rcauchy(n, location = 0, scale = 1)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;location, scale&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;location and scale parameters.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;code&gt;location&lt;/code&gt; or &lt;code&gt;scale&lt;/code&gt; are not specified, they assume&#10;the default values of &lt;code&gt;0&lt;/code&gt; and &lt;code&gt;1&lt;/code&gt; respectively.&#10;&lt;/p&gt;&#10;&lt;p&gt;The Cauchy distribution with location &lt;i&gt;l&lt;/i&gt; and scale &lt;i&gt;s&lt;/i&gt; has&#10;density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = 1 / (&amp;pi; s (1 + ((x-l)/s)^2))&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for all &lt;i&gt;x&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dcauchy&lt;/code&gt;, &lt;code&gt;pcauchy&lt;/code&gt;, and &lt;code&gt;qcauchy&lt;/code&gt; are respectively&#10;the density, distribution function and quantile function of the Cauchy&#10;distribution.  &lt;code&gt;rcauchy&lt;/code&gt; generates random deviates from the&#10;Cauchy.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rcauchy&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.    &#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dcauchy&lt;/code&gt;, &lt;code&gt;pcauchy&lt;/code&gt; and &lt;code&gt;qcauchy&lt;/code&gt; are all calculated&#10;from numerically stable versions of the definitions.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rcauchy&lt;/code&gt; uses inversion.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 1, chapter 16.&#10;Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dt&lt;/code&gt; for the t distribution which generalizes&#10;&lt;code&gt;dcauchy(*, l = 0, s = 1)&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dcauchy(-1:4)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The (non-central) Chi-Squared Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Chisquare&quot;&gt;&lt;tr&gt;&lt;td&gt;Chisquare&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The (non-central) Chi-Squared Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the chi-squared (&lt;i&gt;chi^2&lt;/i&gt;) distribution with&#10;&lt;code&gt;df&lt;/code&gt; degrees of freedom and optional non-centrality parameter&#10;&lt;code&gt;ncp&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dchisq(x, df, ncp = 0, log = FALSE)&#10;pchisq(q, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)&#10;qchisq(p, df, ncp = 0, lower.tail = TRUE, log.p = FALSE)&#10;rchisq(n, df, ncp = 0)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;df&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;degrees of freedom (non-negative, but can be non-integer).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;ncp&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;non-centrality parameter (non-negative).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The chi-squared distribution with &lt;code&gt;df&lt;/code&gt;&lt;i&gt;= n &amp;ge; 0&lt;/i&gt;&#10;degrees of freedom has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f_n(x) = 1 / (2^(n/2) &amp;Gamma;(n/2))  x^(n/2-1) e^(-x/2)&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x &amp;gt; 0&lt;/i&gt;, where &lt;i&gt;f_0(x) := \\lim_{n \\to 0} f_n(x) =&#10;  &amp;delta;_0(x)&lt;/i&gt;, a point mass at zero, is not a density function proper, but&#10;a &amp;ldquo;&lt;i&gt;&amp;delta;&lt;/i&gt; distribution&amp;rdquo;.&lt;br /&gt;&#10;The mean and variance are &lt;i&gt;n&lt;/i&gt; and &lt;i&gt;2n&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The non-central chi-squared distribution with &lt;code&gt;df&lt;/code&gt;&lt;i&gt;= n&lt;/i&gt;&#10;degrees of freedom and non-centrality parameter &lt;code&gt;ncp&lt;/code&gt;&#10;&lt;i&gt;= &amp;lambda;&lt;/i&gt; has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = exp(-&amp;lambda;/2) SUM_{r=0}^&amp;infin; ((&amp;lambda;/2)^r / r!) dchisq(x, df + 2r)&#10;  &lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x &amp;ge; 0&lt;/i&gt;.  For integer &lt;i&gt;n&lt;/i&gt;, this is the distribution of&#10;the sum of squares of &lt;i&gt;n&lt;/i&gt; normals each with variance one,&#10;&lt;i&gt;&amp;lambda;&lt;/i&gt; being the sum of squares of the normal means; further,&#10;&lt;br /&gt;&#10;&lt;i&gt;E(X) = n + &amp;lambda;&lt;/i&gt;, &lt;i&gt;Var(X) = 2(n + 2*&amp;lambda;)&lt;/i&gt;, and&#10;&lt;i&gt;E((X - E(X))^3) = 8(n + 3*&amp;lambda;)&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that the degrees of freedom &lt;code&gt;df&lt;/code&gt;&lt;i&gt;= n&lt;/i&gt;, can be&#10;non-integer, and also &lt;i&gt;n = 0&lt;/i&gt; which is relevant for&#10;non-centrality &lt;i&gt;&amp;lambda; &amp;gt; 0&lt;/i&gt;,&#10;see Johnson &lt;em&gt;et al&lt;/em&gt; (1995, chapter 29).&#10;In that (noncentral, zero df) case, the distribution is a mixture of a&#10;point mass at &lt;i&gt;x = 0&lt;/i&gt; (of size &lt;code&gt;pchisq(0, df=0, ncp=ncp)&lt;/code&gt;) and&#10;a continuous part, and &lt;code&gt;dchisq()&lt;/code&gt; is &lt;em&gt;not&lt;/em&gt; a density with&#10;respect to that mixture measure but rather the limit of the density&#10;for &lt;i&gt;df -&amp;gt; 0&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that &lt;code&gt;ncp&lt;/code&gt; values larger than about 1e5 (and even smaller)  may give inaccurate&#10;results with many warnings for &lt;code&gt;pchisq&lt;/code&gt; and &lt;code&gt;qchisq&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dchisq&lt;/code&gt; gives the density, &lt;code&gt;pchisq&lt;/code&gt; gives the distribution&#10;function, &lt;code&gt;qchisq&lt;/code&gt; gives the quantile function, and &lt;code&gt;rchisq&lt;/code&gt;&#10;generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid arguments will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rchisq&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;Supplying &lt;code&gt;ncp = 0&lt;/code&gt; uses the algorithm for the non-central&#10;distribution, which is not the same algorithm used if &lt;code&gt;ncp&lt;/code&gt; is&#10;omitted.  This is to give consistent behaviour in extreme cases with&#10;values of &lt;code&gt;ncp&lt;/code&gt; very near zero.&#10;&lt;/p&gt;&#10;&lt;p&gt;The code for non-zero &lt;code&gt;ncp&lt;/code&gt; is principally intended to be used&#10;for moderate values of &lt;code&gt;ncp&lt;/code&gt;: it will not be highly accurate,&#10;especially in the tails, for large values.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;The central cases are computed via the gamma distribution.&#10;&lt;/p&gt;&#10;&lt;p&gt;The non-central &lt;code&gt;dchisq&lt;/code&gt; and &lt;code&gt;rchisq&lt;/code&gt; are computed as a&#10;Poisson mixture of central chi-squares (Johnson &lt;em&gt;et al&lt;/em&gt;, 1995, p.436).&#10;&lt;/p&gt;&#10;&lt;p&gt;The non-central &lt;code&gt;pchisq&lt;/code&gt; is for &lt;code&gt;ncp &amp;lt; 80&lt;/code&gt; computed from&#10;the Poisson mixture of central chi-squares and for larger &lt;code&gt;ncp&lt;/code&gt;&#10;&lt;em&gt;via&lt;/em&gt; a C translation of&#10;&lt;/p&gt;&#10;&lt;p&gt;Ding, C. G. (1992)&#10;Algorithm AS275: Computing the non-central chi-squared&#10;distribution function. &lt;em&gt;Appl.Statist.&lt;/em&gt;, &lt;b&gt;41&lt;/b&gt; 478&amp;ndash;482.&#10;&lt;/p&gt;&#10;&lt;p&gt;which computes the lower tail only (so the upper tail suffers from&#10;cancellation and a warning will be given when this is likely to be&#10;significant).&#10;&lt;/p&gt;&#10;&lt;p&gt;The non-central &lt;code&gt;qchisq&lt;/code&gt; is based on inversion of &lt;code&gt;pchisq&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, chapters 18 (volume 1)&#10;and 29 (volume 2). Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions.&#10;&lt;/p&gt;&#10;&lt;p&gt;A central chi-squared distribution with &lt;i&gt;n&lt;/i&gt; degrees of freedom&#10;is the same as a Gamma distribution with &lt;code&gt;shape&lt;/code&gt; &lt;i&gt;a = n/2&lt;/i&gt; and &lt;code&gt;scale&lt;/code&gt; &lt;i&gt;s = 2&lt;/i&gt;.  Hence, see&#10;&lt;code&gt;dgamma&lt;/code&gt; for the Gamma distribution.&#10;&lt;/p&gt;&#10;&lt;p&gt;The central chi-squared distribution with 2 d.f. is identical to the&#10;exponential distribution with rate 1/2: &lt;i&gt;&amp;chi;^2_2 = Exp(1/2)&lt;/i&gt;, see&#10;&lt;code&gt;dexp&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;dchisq(1, df = 1:3)&#10;pchisq(1, df =  3)&#10;pchisq(1, df =  3, ncp = 0:4)  # includes the above&#10;&#10;x &amp;lt;- 1:10&#10;## Chi-squared(df = 2) is a special exponential distribution&#10;all.equal(dchisq(x, df = 2), dexp(x, 1/2))&#10;all.equal(pchisq(x, df = 2), pexp(x, 1/2))&#10;&#10;## non-central RNG -- df = 0 with ncp &amp;gt; 0:  Z0 has point mass at 0!&#10;Z0 &amp;lt;- rchisq(100, df = 0, ncp = 2.)&#10;graphics::stem(Z0)&#10;&#10;## visual testing&#10;## do P-P plots for 1000 points at various degrees of freedom&#10;L &amp;lt;- 1.2; n &amp;lt;- 1000; pp &amp;lt;- ppoints(n)&#10;op &amp;lt;- par(mfrow = c(3,3), mar = c(3,3,1,1)+.1, mgp = c(1.5,.6,0),&#10;          oma = c(0,0,3,0))&#10;for(df in 2^(4*rnorm(9))) {&#10;  plot(pp, sort(pchisq(rr &amp;lt;- rchisq(n, df = df, ncp = L), df = df, ncp = L)),&#10;       ylab = &quot;pchisq(rchisq(.),.)&quot;, pch = &quot;.&quot;)&#10;  mtext(paste(&quot;df = &quot;, formatC(df, digits = 4)), line =  -2, adj = 0.05)&#10;  abline(0, 1, col = 2)&#10;}&#10;mtext(expression(&quot;P-P plots : Noncentral  &quot;*&#10;                 chi^2 *&quot;(n=1000, df=X, ncp= 1.2)&quot;),&#10;      cex = 1.5, font = 2, outer = TRUE)&#10;par(op)&#10;&#10;## &quot;analytical&quot; test&#10;lam &amp;lt;- seq(0, 100, by = .25)&#10;p00 &amp;lt;- pchisq(0,      df = 0, ncp = lam)&#10;p.0 &amp;lt;- pchisq(1e-300, df = 0, ncp = lam)&#10;stopifnot(all.equal(p00, exp(-lam/2)),&#10;          all.equal(p.0, exp(-lam/2)))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Manipulate Flat Contingency Tables&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for read.ftable&quot;&gt;&lt;tr&gt;&lt;td&gt;read.ftable&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Manipulate Flat Contingency Tables&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Read, write and coerce &amp;lsquo;flat&amp;rsquo; contingency tables.&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;read.ftable(file, sep = &quot;&quot;, quote = &quot;\\&quot;&quot;,&#10;            row.var.names, col.vars, skip = 0)&#10;&#10;write.ftable(x, file = &quot;&quot;, quote = TRUE, append = FALSE,&#10;             digits = getOption(&quot;digits&quot;), ...)&#10;&#10;## S3 method for class &#39;ftable&#39;&#10;format(x, quote = TRUE, digits = getOption(&quot;digits&quot;),&#10;                        method = c(&quot;non.compact&quot;, &quot;row.compact&quot;,&#10;                                  &quot;col.compact&quot;, &quot;compact&quot;),&#10;                        lsep = &quot; | &quot;, ...)&#10;## S3 method for class &#39;ftable&#39;&#10;print(x, digits = getOption(&quot;digits&quot;), ...)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;file&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;either a character string naming a file or a connection&#10;which the data are to be read from or written to.  &lt;code&gt;&quot;&quot;&lt;/code&gt;&#10;indicates input from the console for reading and output to the&#10;console for writing.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;sep&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the field separator string.  Values on each line of the file&#10;are separated by this string.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;quote&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;a character string giving the set of quoting characters&#10;for &lt;code&gt;read.ftable&lt;/code&gt;; to disable quoting altogether, use&#10;&lt;code&gt;quote=&quot;&quot;&lt;/code&gt;.  For &lt;code&gt;write.table&lt;/code&gt;, a logical indicating&#10;whether strings in the data will be surrounded by double quotes.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;row.var.names&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;a character vector with the names of the row&#10;variables, in case these cannot be determined automatically.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;col.vars&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;a list giving the names and levels of the column&#10;variables, in case these cannot be determined automatically.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;skip&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the number of lines of the data file to skip before&#10;beginning to read data.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an object of class &lt;code&gt;&quot;ftable&quot;&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;append&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical.  If &lt;code&gt;TRUE&lt;/code&gt; and &lt;code&gt;file&lt;/code&gt; is the name of&#10;a file (and not a connection or &lt;code&gt;&quot;|cmd&quot;&lt;/code&gt;), the output from&#10;&lt;code&gt;write.ftable&lt;/code&gt; is appended to the file.  If &lt;code&gt;FALSE&lt;/code&gt;,&#10;the contents of &lt;code&gt;file&lt;/code&gt; will be overwritten.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;digits&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an integer giving the number of significant digits to&#10;use for (the cell entries of) &lt;code&gt;x&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;method&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;string specifying how the &lt;code&gt;&quot;ftable&quot;&lt;/code&gt; object is formatted&#10;(and printed if used as in &lt;code&gt;write.ftable()&lt;/code&gt; or the &lt;code&gt;print&lt;/code&gt;&#10;method).  Can be abbreviated.  Available methods are (see the examples):&#10;&lt;/p&gt;&#10;&#10;&lt;dl&gt;&#10;&lt;dt&gt;&amp;quot;non.compact&amp;quot;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;the default representation of an&#10;&lt;code&gt;&quot;ftable&quot;&lt;/code&gt; object.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&amp;quot;row.compact&amp;quot;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;a row-compact version without empty cells&#10;below the column labels.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&amp;quot;col.compact&amp;quot;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;a column-compact version without empty cells&#10;to the right of the row labels.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&amp;quot;compact&amp;quot;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;a row- and column-compact version.  This may imply&#10;a row and a column label sharing the same cell.  They are then&#10;separated by the string &lt;code&gt;lsep&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;/dl&gt;&#10;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lsep&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;only for &lt;code&gt;method = &quot;compact&quot;&lt;/code&gt;, the separation string&#10;for row and column labels.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;further arguments to be passed to or&#10;from methods; for &lt;code&gt;write()&lt;/code&gt; and &lt;code&gt;print()&lt;/code&gt;, notably&#10;arguments such as &lt;code&gt;method&lt;/code&gt;, passed to &lt;code&gt;format()&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;read.ftable&lt;/code&gt; reads in a flat-like contingency table from a&#10;file.  If the file contains the written representation of a flat&#10;table (more precisely, a header with all information on names and&#10;levels of column variables, followed by a line with the names of the&#10;row variables), no further arguments are needed.  Similarly, flat&#10;tables with only one column variable the name of which is the only&#10;entry in the first line are handled automatically.  Other variants can&#10;be dealt with by skipping all header information using &lt;code&gt;skip&lt;/code&gt;,&#10;and providing the names of the row variables and the names and levels&#10;of the column variable using &lt;code&gt;row.var.names&lt;/code&gt; and &lt;code&gt;col.vars&lt;/code&gt;,&#10;respectively.  See the examples below.&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that flat tables are characterized by their &amp;lsquo;ragged&amp;rsquo;&#10;display of row (and maybe also column) labels.  If the full grid of&#10;levels of the row variables is given, one should instead use&#10;&lt;code&gt;read.table&lt;/code&gt; to read in the data, and create the&#10;contingency table from this using &lt;code&gt;xtabs&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;write.ftable&lt;/code&gt; writes a flat table to a file, which is useful for&#10;generating &amp;lsquo;pretty&amp;rsquo; ASCII representations of contingency&#10;tables.  Different versions are available via the &lt;code&gt;method&lt;/code&gt;&#10;argument, which may be useful, for example, for constructing LaTeX tables.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Agresti, A. (1990)&#10;&lt;em&gt;Categorical data analysis&lt;/em&gt;.&#10;New York: Wiley.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;ftable&lt;/code&gt; for more information on flat contingency tables.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;## Agresti (1990), page 157, Table 5.8.&#10;## Not in ftable standard format, but o.k.&#10;file &amp;lt;- tempfile()&#10;cat(&quot;             Intercourse\\n&quot;,&#10;    &quot;Race  Gender     Yes  No\\n&quot;,&#10;    &quot;White Male        43 134\\n&quot;,&#10;    &quot;      Female      26 149\\n&quot;,&#10;    &quot;Black Male        29  23\\n&quot;,&#10;    &quot;      Female      22  36\\n&quot;,&#10;    file = file)&#10;file.show(file)&#10;ft1 &amp;lt;- read.ftable(file)&#10;ft1&#10;unlink(file)&#10;&#10;## Agresti (1990), page 297, Table 8.16.&#10;## Almost o.k., but misses the name of the row variable.&#10;file &amp;lt;- tempfile()&#10;cat(&quot;                      \\&quot;Tonsil Size\\&quot;\\n&quot;,&#10;    &quot;            \\&quot;Not Enl.\\&quot; \\&quot;Enl.\\&quot; \\&quot;Greatly Enl.\\&quot;\\n&quot;,&#10;    &quot;Noncarriers       497     560           269\\n&quot;,&#10;    &quot;Carriers           19      29            24\\n&quot;,&#10;    file = file)&#10;file.show(file)&#10;ft &amp;lt;- read.ftable(file, skip = 2,&#10;                  row.var.names = &quot;Status&quot;,&#10;                  col.vars = list(&quot;Tonsil Size&quot; =&#10;                      c(&quot;Not Enl.&quot;, &quot;Enl.&quot;, &quot;Greatly Enl.&quot;)))&#10;ft&#10;unlink(file)&#10;&#10;ft22 &amp;lt;- ftable(Titanic, row.vars = 2:1, col.vars = 4:3)&#10;write.ftable(ft22, quote = FALSE)&#10;write.ftable(ft22, quote = FALSE, method=&quot;row.compact&quot;)&#10;write.ftable(ft22, quote = FALSE, method=&quot;col.compact&quot;)&#10;write.ftable(ft22, quote = FALSE, method=&quot;compact&quot;)&#10;&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Draw Rectangles Around Hierarchical Clusters&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for rect.hclust&quot;&gt;&lt;tr&gt;&lt;td&gt;rect.hclust&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Draw Rectangles Around Hierarchical Clusters&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Draws rectangles around the branches of a dendrogram highlighting the&#10;corresponding clusters. First the dendrogram is cut at a certain&#10;level, then a rectangle is drawn around selected branches.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;rect.hclust(tree, k = NULL, which = NULL, x = NULL, h = NULL,&#10;            border = 2, cluster = NULL)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;tree&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an object of the type produced by &lt;code&gt;hclust&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;k, h&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;Scalar. Cut the dendrogram such that either exactly&#10;&lt;code&gt;k&lt;/code&gt; clusters are produced or by cutting at height &lt;code&gt;h&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;which, x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;A vector selecting the clusters around which a&#10;rectangle should be drawn. &lt;code&gt;which&lt;/code&gt; selects clusters by number&#10;(from left to right in the tree), &lt;code&gt;x&lt;/code&gt; selects clusters&#10;containing the respective horizontal coordinates. Default is&#10;&lt;code&gt;which = 1:k&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;border&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;Vector with border colors for the rectangles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;cluster&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;Optional vector with cluster memberships as returned by&#10;&lt;code&gt;cutree(hclust.obj, k = k)&lt;/code&gt;, can be specified for efficiency if&#10;already computed.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;(Invisibly) returns a list where each element contains a vector of&#10;data points contained in the respective cluster.&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;hclust&lt;/code&gt;, &lt;code&gt;identify.hclust&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;hca &amp;lt;- hclust(dist(USArrests))&#10;plot(hca)&#10;rect.hclust(hca, k = 3, border = &quot;red&quot;)&#10;x &amp;lt;- rect.hclust(hca, h = 50, which = c(2,7), border = 3:4)&#10;x&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Modify Terms Objects&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for delete.response&quot;&gt;&lt;tr&gt;&lt;td&gt;delete.response&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Modify Terms Objects&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;delete.response&lt;/code&gt; returns a &lt;code&gt;terms&lt;/code&gt; object for the same&#10;model but with no response variable.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;drop.terms&lt;/code&gt; removes variables from the right-hand side of the&#10;model. There is also a &lt;code&gt;&quot;[.terms&quot;&lt;/code&gt; method to perform the same&#10;function (with &lt;code&gt;keep.response = TRUE&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;reformulate&lt;/code&gt; creates a formula from a character vector.  If&#10;&lt;code&gt;length(termlabels) &amp;gt; 1&lt;/code&gt;, its elements are concatenated with &lt;code&gt;+&lt;/code&gt;.&#10;Non-syntactic names (e.g. containing spaces or special characters; see&#10;&lt;code&gt;make.names&lt;/code&gt;) must be protected with backticks  (see examples).&#10;A non-&lt;code&gt;parse&lt;/code&gt;able &lt;code&gt;response&lt;/code&gt; still works for now,&#10;back compatibly, with a deprecation warning.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;delete.response(termobj)&#10;&#10;reformulate(termlabels, response = NULL, intercept = TRUE, env = parent.frame())&#10;&#10;drop.terms(termobj, dropx = NULL, keep.response = FALSE)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;termobj&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;A &lt;code&gt;terms&lt;/code&gt; object&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;termlabels&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;character vector giving the right-hand side of a&#10;model formula.  Cannot be zero-length.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;response&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;character string, symbol or call giving the left-hand&#10;side of a model formula, or &lt;code&gt;NULL&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;intercept&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical: should the formula have an intercept?&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;env&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the &lt;code&gt;environment&lt;/code&gt; of the &lt;code&gt;formula&lt;/code&gt;&#10;returned.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;dropx&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of positions of variables to drop from the&#10;right-hand side of the model.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;keep.response&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;Keep the response in the resulting object?&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;delete.response&lt;/code&gt; and &lt;code&gt;drop.terms&lt;/code&gt; return a &lt;code&gt;terms&lt;/code&gt;&#10;object.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;reformulate&lt;/code&gt; returns a &lt;code&gt;formula&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;terms&lt;/code&gt;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;ff &amp;lt;- y ~ z + x + w&#10;tt &amp;lt;- terms(ff)&#10;tt&#10;delete.response(tt)&#10;drop.terms(tt, 2:3, keep.response = TRUE)&#10;tt[-1]&#10;tt[2:3]&#10;reformulate(attr(tt, &quot;term.labels&quot;))&#10;&#10;## keep LHS :&#10;reformulate(&quot;x*w&quot;, ff[[2]])&#10;fS &amp;lt;- surv(ft, case) ~ a + b&#10;reformulate(c(&quot;a&quot;, &quot;b*f&quot;), fS[[2]])&#10;&#10;## using non-syntactic names:&#10;reformulate(c(&quot;`P/E`&quot;, &quot;`% Growth`&quot;), response = as.name(&quot;+-&quot;))&#10;&#10;x &amp;lt;- c(&quot;a name&quot;, &quot;another name&quot;)&#10;try( reformulate(x) ) # -&amp;gt; Error ..... unexpected symbol&#10;## rather backquote the strings in x :&#10;reformulate(sprintf(&quot;`%s`&quot;, x))&#10;&#10;stopifnot(identical(      ~ var, reformulate(&quot;var&quot;)),&#10;          identical(~ a + b + c, reformulate(letters[1:3])),&#10;          identical(  y ~ a + b, reformulate(letters[1:2], &quot;y&quot;))&#10;         )&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Reorder Levels of Factor&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for relevel&quot;&gt;&lt;tr&gt;&lt;td&gt;relevel&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Reorder Levels of Factor&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;The levels of a factor are re-ordered so that the level specified by&#10;&lt;code&gt;ref&lt;/code&gt; is first and the others are moved down. This is useful&#10;for &lt;code&gt;contr.treatment&lt;/code&gt; contrasts which take the first level as&#10;the reference.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;relevel(x, ref, ...)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an unordered factor.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;ref&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the reference level, typically a string.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;additional arguments for future methods.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;This, as &lt;code&gt;reorder()&lt;/code&gt;, is a special case of simply calling&#10;&lt;code&gt;factor(x, levels = levels(x)[....])&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;A factor of the same length as &lt;code&gt;x&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;factor&lt;/code&gt;, &lt;code&gt;contr.treatment&lt;/code&gt;,&#10;&lt;code&gt;levels&lt;/code&gt;, &lt;code&gt;reorder&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;warpbreaks$tension &amp;lt;- relevel(warpbreaks$tension, ref = &quot;M&quot;)&#10;summary(lm(breaks ~ wool + tension, data = warpbreaks))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Reorder Levels of a Factor&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for reorder.default&quot;&gt;&lt;tr&gt;&lt;td&gt;reorder.default&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Reorder Levels of a Factor&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;reorder&lt;/code&gt; is a generic function.  The &lt;code&gt;&quot;default&quot;&lt;/code&gt; method&#10;treats its first argument as a categorical variable, and reorders its&#10;levels based on the values of a second variable, usually numeric.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;reorder(x, ...)&#10;&#10;## Default S3 method:&#10;reorder(x, X, FUN = mean, ...,&#10;        order = is.ordered(x))&#10;&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an atomic vector, usually a &lt;code&gt;factor&lt;/code&gt; (possibly&#10;ordered).  The vector is treated as a categorical variable whose&#10;levels will be reordered.  If &lt;code&gt;x&lt;/code&gt; is not a factor, its unique&#10;values will be used as the implicit levels.&#10;&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;X&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt; a vector of the same length as &lt;code&gt;x&lt;/code&gt;, whose subset&#10;of values for each unique level of &lt;code&gt;x&lt;/code&gt; determines the&#10;eventual order of that level.&#10;&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;FUN&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;a &lt;code&gt;function&lt;/code&gt; whose first argument is a vector&#10;and returns a scalar, to be applied to each subset of &lt;code&gt;X&lt;/code&gt;&#10;determined by the levels of &lt;code&gt;x&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt; optional: extra arguments supplied to &lt;code&gt;FUN&lt;/code&gt;&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;order&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt; logical, whether return value will be an ordered factor&#10;rather than a factor.&#10;&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;This, as &lt;code&gt;relevel()&lt;/code&gt;, is a special case of simply calling&#10;&lt;code&gt;factor(x, levels = levels(x)[....])&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;A factor or an ordered factor (depending on the value of&#10;&lt;code&gt;order&lt;/code&gt;), with the order of the levels determined by&#10;&lt;code&gt;FUN&lt;/code&gt; applied to &lt;code&gt;X&lt;/code&gt; grouped by &lt;code&gt;x&lt;/code&gt;.  The&#10;levels are ordered such that the values returned by &lt;code&gt;FUN&lt;/code&gt;&#10;are in increasing order.  Empty levels will be dropped.&#10;&lt;/p&gt;&#10;&lt;p&gt;Additionally, the values of &lt;code&gt;FUN&lt;/code&gt; applied to the subsets of&#10;&lt;code&gt;X&lt;/code&gt; (in the original order of the levels of &lt;code&gt;x&lt;/code&gt;) is returned&#10;as the &lt;code&gt;&quot;scores&quot;&lt;/code&gt; attribute.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Author(s)&lt;/h3&gt;&#10;&#10;&lt;p&gt;Deepayan Sarkar &lt;a href=&quot;mailto:deepayan.sarkar@r-project.org&quot;&gt;deepayan.sarkar@r-project.org&lt;/a&gt;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;reorder.dendrogram&lt;/code&gt;, &lt;code&gt;levels&lt;/code&gt;,&#10;&lt;code&gt;relevel&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;bymedian &amp;lt;- with(InsectSprays, reorder(spray, count, median))&#10;boxplot(count ~ bymedian, data = InsectSprays,&#10;        xlab = &quot;Type of spray&quot;, ylab = &quot;Insect count&quot;,&#10;        main = &quot;InsectSprays data&quot;, varwidth = TRUE,&#10;        col = &quot;lightgray&quot;)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Number of Replications of Terms&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for replications&quot;&gt;&lt;tr&gt;&lt;td&gt;replications&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Number of Replications of Terms&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Returns a vector or a list of the number of replicates for&#10;each term in the formula.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;replications(formula, data = NULL, na.action)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;formula&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;a formula or a terms object or a data frame.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;data&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;a data frame used  to  find  the  objects in &lt;code&gt;formula&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;na.action&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;function for handling missing values.  Defaults to&#10;a &lt;code&gt;na.action&lt;/code&gt; attribute of &lt;code&gt;data&lt;/code&gt;, then&#10;a setting of the option &lt;code&gt;na.action&lt;/code&gt;, or &lt;code&gt;na.fail&lt;/code&gt; if that&#10;is not set.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;code&gt;formula&lt;/code&gt; is a data frame and &lt;code&gt;data&lt;/code&gt; is missing,&#10;&lt;code&gt;formula&lt;/code&gt; is used for &lt;code&gt;data&lt;/code&gt; with the formula &lt;code&gt;~ .&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Any character vectors in the formula are coerced to factors.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;A vector or list with one entry for each term in the formula giving&#10;the number(s) of replications for each level. If all levels are&#10;balanced (have the same number of replications) the result is a&#10;vector, otherwise it is a list with a component for each terms,&#10;as a vector, matrix or array as required.&#10;&lt;/p&gt;&#10;&lt;p&gt;A test for balance is &lt;code&gt;!is.list(replications(formula,data))&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Author(s)&lt;/h3&gt;&#10;&#10;&lt;p&gt;The design was inspired by the S function of the same name described&#10;in Chambers &lt;em&gt;et al&lt;/em&gt; (1992).&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Chambers, J. M., Freeny, A and Heiberger, R. M. (1992)&#10;&lt;em&gt;Analysis of variance; designed experiments.&lt;/em&gt;&#10;Chapter 5 of &lt;em&gt;Statistical Models in S&lt;/em&gt;&#10;eds J. M. Chambers and T. J. Hastie, Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;model.tables&lt;/code&gt;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;## From Venables and Ripley (2002) p.165.&#10;N &amp;lt;- c(0,1,0,1,1,1,0,0,0,1,1,0,1,1,0,0,1,0,1,0,1,1,0,0)&#10;P &amp;lt;- c(1,1,0,0,0,1,0,1,1,1,0,0,0,1,0,1,1,0,0,1,0,1,1,0)&#10;K &amp;lt;- c(1,0,0,1,0,1,1,0,0,1,0,1,0,1,1,0,0,0,1,1,1,0,1,0)&#10;yield &amp;lt;- c(49.5,62.8,46.8,57.0,59.8,58.5,55.5,56.0,62.8,55.8,69.5,&#10;55.0, 62.0,48.8,45.5,44.2,52.0,51.5,49.8,48.8,57.2,59.0,53.2,56.0)&#10;&#10;npk &amp;lt;- data.frame(block = gl(6,4), N = factor(N), P = factor(P),&#10;                  K = factor(K), yield = yield)&#10;replications(~ . - yield, npk)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Reshape Grouped Data&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for reshape&quot;&gt;&lt;tr&gt;&lt;td&gt;reshape&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Reshape Grouped Data&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;This function reshapes a data frame between &amp;lsquo;wide&amp;rsquo; format with&#10;repeated measurements in separate columns of the same record and&#10;&amp;lsquo;long&amp;rsquo; format with the repeated measurements in separate&#10;records.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;reshape(data, varying = NULL, v.names = NULL, timevar = &quot;time&quot;,&#10;        idvar = &quot;id&quot;, ids = 1:NROW(data),&#10;        times = seq_along(varying[[1]]),&#10;        drop = NULL, direction, new.row.names = NULL,&#10;        sep = &quot;.&quot;,&#10;        split = if (sep == &quot;&quot;) {&#10;            list(regexp = &quot;[A-Za-z][0-9]&quot;, include = TRUE)&#10;        } else {&#10;            list(regexp = sep, include = FALSE, fixed = TRUE)}&#10;        )&#10;&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;data&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;a data frame&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;varying&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;names of sets of variables in the wide format that&#10;correspond to single variables in long format&#10;(&amp;lsquo;time-varying&amp;rsquo;).  This is canonically a list of vectors of&#10;variable names, but it can optionally be a matrix of names, or a&#10;single vector of names.  In each case, the names can be replaced by&#10;indices which are interpreted as referring to &lt;code&gt;names(data)&lt;/code&gt;.&#10;See &amp;lsquo;Details&amp;rsquo; for more details and options.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;v.names&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;names of variables in the long format that correspond&#10;to multiple variables in the wide format.  See &amp;lsquo;Details&amp;rsquo;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;timevar&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the variable in long format that differentiates multiple&#10;records from the same group or individual.  If more than one record&#10;matches, the first will be taken (with a warning). &lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;idvar&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;Names of one or more variables in long format that&#10;identify multiple records from the same group/individual.  These&#10;variables may also be present in wide format.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;ids&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the values to use for a newly created &lt;code&gt;idvar&lt;/code&gt;&#10;variable in long format.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;times&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the values to use for a newly created &lt;code&gt;timevar&lt;/code&gt;&#10;variable in long format.  See &amp;lsquo;Details&amp;rsquo;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;drop&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;a vector of names of variables to drop before reshaping.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;direction&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;character string, partially matched to either&#10;&lt;code&gt;&quot;wide&quot;&lt;/code&gt; to reshape to wide format, or &lt;code&gt;&quot;long&quot;&lt;/code&gt; to reshape&#10;to long format.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;new.row.names&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;character or &lt;code&gt;NULL&lt;/code&gt;: a non-null value will be&#10;used for the row names of the result.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;sep&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;A character vector of length 1, indicating a separating&#10;character in the variable names in the wide format.  This is used for&#10;guessing &lt;code&gt;v.names&lt;/code&gt; and &lt;code&gt;times&lt;/code&gt; arguments based on the&#10;names in &lt;code&gt;varying&lt;/code&gt;.  If &lt;code&gt;sep == &quot;&quot;&lt;/code&gt;, the split is just before&#10;the first numeral that follows an alphabetic character.  This is&#10;also used to create variable names when reshaping to wide format.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;split&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;A list with three components, &lt;code&gt;regexp&lt;/code&gt;,&#10;&lt;code&gt;include&lt;/code&gt;, and (optionally) &lt;code&gt;fixed&lt;/code&gt;.  This allows an&#10;extended interface to variable name splitting.  See &amp;lsquo;Details&amp;rsquo;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The arguments to this function are described in terms of longitudinal&#10;data, as that is the application motivating the functions.  A&#10;&amp;lsquo;wide&amp;rsquo; longitudinal dataset will have one record for each&#10;individual with some time-constant variables that occupy single&#10;columns and some time-varying variables that occupy a column for each&#10;time point.  In &amp;lsquo;long&amp;rsquo; format there will be multiple records&#10;for each individual, with some variables being constant across these&#10;records and others varying across the records.  A &amp;lsquo;long&amp;rsquo; format&#10;dataset also needs a &amp;lsquo;time&amp;rsquo; variable identifying which time&#10;point each record comes from and an &amp;lsquo;id&amp;rsquo; variable showing which&#10;records refer to the same person.&#10;&lt;/p&gt;&#10;&lt;p&gt;If the data frame resulted from a previous &lt;code&gt;reshape&lt;/code&gt; then the&#10;operation can be reversed simply by &lt;code&gt;reshape(a)&lt;/code&gt;.  The&#10;&lt;code&gt;direction&lt;/code&gt; argument is optional and the other arguments are&#10;stored as attributes on the data frame.&#10;&lt;/p&gt;&#10;&lt;p&gt;If &lt;code&gt;direction = &quot;wide&quot;&lt;/code&gt; and no &lt;code&gt;varying&lt;/code&gt; or &lt;code&gt;v.names&lt;/code&gt;&#10;arguments are supplied it is assumed that all variables except&#10;&lt;code&gt;idvar&lt;/code&gt; and &lt;code&gt;timevar&lt;/code&gt; are time-varying.  They are all&#10;expanded into multiple variables in wide format.&#10;&lt;/p&gt;&#10;&lt;p&gt;If &lt;code&gt;direction = &quot;long&quot;&lt;/code&gt; the &lt;code&gt;varying&lt;/code&gt; argument can be a vector&#10;of column names (or a corresponding index).  The function will attempt&#10;to guess the &lt;code&gt;v.names&lt;/code&gt; and &lt;code&gt;times&lt;/code&gt; from these names.  The&#10;default is variable names like &lt;code&gt;x.1&lt;/code&gt;, &lt;code&gt;x.2&lt;/code&gt;, where&#10;&lt;code&gt;sep = &quot;.&quot;&lt;/code&gt; specifies to split at the dot and drop it from the&#10;name.  To have alphabetic followed by numeric times use &lt;code&gt;sep = &quot;&quot;&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Variable name splitting as described above is only attempted in the&#10;case where &lt;code&gt;varying&lt;/code&gt; is an atomic vector, if it is a list or a&#10;matrix, &lt;code&gt;v.names&lt;/code&gt; and &lt;code&gt;times&lt;/code&gt; will generally need to be&#10;specified, although they will default to, respectively, the first&#10;variable name in each set, and sequential times.&#10;&lt;/p&gt;&#10;&lt;p&gt;Also, guessing is not attempted if &lt;code&gt;v.names&lt;/code&gt; is given&#10;explicitly.  Notice that the order of variables in &lt;code&gt;varying&lt;/code&gt; is&#10;like &lt;code&gt;x.1&lt;/code&gt;,&lt;code&gt;y.1&lt;/code&gt;,&lt;code&gt;x.2&lt;/code&gt;,&lt;code&gt;y.2&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The &lt;code&gt;split&lt;/code&gt; argument should not usually be necessary.  The&#10;&lt;code&gt;split$regexp&lt;/code&gt; component is passed to either&#10;&lt;code&gt;strsplit&lt;/code&gt; or &lt;code&gt;regexpr&lt;/code&gt;, where the latter is&#10;used if &lt;code&gt;split$include&lt;/code&gt; is &lt;code&gt;TRUE&lt;/code&gt;, in which case the&#10;splitting occurs after the first character of the matched string.  In&#10;the &lt;code&gt;strsplit&lt;/code&gt; case, the separator is not included in the&#10;result, and it is possible to specify fixed-string matching using&#10;&lt;code&gt;split$fixed&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;The reshaped data frame with added attributes to simplify reshaping&#10;back to the original form.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;stack&lt;/code&gt;, &lt;code&gt;aperm&lt;/code&gt;;&#10;&lt;code&gt;relist&lt;/code&gt; for reshaping the result of &lt;code&gt;unlist&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;summary(Indometh)&#10;wide &amp;lt;- reshape(Indometh, v.names = &quot;conc&quot;, idvar = &quot;Subject&quot;,&#10;                timevar = &quot;time&quot;, direction = &quot;wide&quot;)&#10;wide&#10;&#10;reshape(wide, direction = &quot;long&quot;)&#10;reshape(wide, idvar = &quot;Subject&quot;, varying = list(2:12),&#10;        v.names = &quot;conc&quot;, direction = &quot;long&quot;)&#10;&#10;## times need not be numeric&#10;df &amp;lt;- data.frame(id = rep(1:4, rep(2,4)),&#10;                 visit = I(rep(c(&quot;Before&quot;,&quot;After&quot;), 4)),&#10;                 x = rnorm(4), y = runif(4))&#10;df&#10;reshape(df, timevar = &quot;visit&quot;, idvar = &quot;id&quot;, direction = &quot;wide&quot;)&#10;## warns that y is really varying&#10;reshape(df, timevar = &quot;visit&quot;, idvar = &quot;id&quot;, direction = &quot;wide&quot;, v.names = &quot;x&quot;)&#10;&#10;&#10;##  unbalanced &#39;long&#39; data leads to NA fill in &#39;wide&#39; form&#10;df2 &amp;lt;- df[1:7, ]&#10;df2&#10;reshape(df2, timevar = &quot;visit&quot;, idvar = &quot;id&quot;, direction = &quot;wide&quot;)&#10;&#10;## Alternative regular expressions for guessing names&#10;df3 &amp;lt;- data.frame(id = 1:4, age = c(40,50,60,50), dose1 = c(1,2,1,2),&#10;                  dose2 = c(2,1,2,1), dose4 = c(3,3,3,3))&#10;reshape(df3, direction = &quot;long&quot;, varying = 3:5, sep = &quot;&quot;)&#10;&#10;&#10;## an example that isn&#39;t longitudinal data&#10;state.x77 &amp;lt;- as.data.frame(state.x77)&#10;long &amp;lt;- reshape(state.x77, idvar = &quot;state&quot;, ids = row.names(state.x77),&#10;                times = names(state.x77), timevar = &quot;Characteristic&quot;,&#10;                varying = list(names(state.x77)), direction = &quot;long&quot;)&#10;&#10;reshape(long, direction = &quot;wide&quot;)&#10;&#10;reshape(long, direction = &quot;wide&quot;, new.row.names = unique(long$state))&#10;&#10;## multiple id variables&#10;df3 &amp;lt;- data.frame(school = rep(1:3, each = 4), class = rep(9:10, 6),&#10;                  time = rep(c(1,1,2,2), 3), score = rnorm(12))&#10;wide &amp;lt;- reshape(df3, idvar = c(&quot;school&quot;,&quot;class&quot;), direction = &quot;wide&quot;)&#10;wide&#10;## transform back&#10;reshape(wide)&#10;&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Extract Model Residuals&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for residuals&quot;&gt;&lt;tr&gt;&lt;td&gt;residuals&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Extract Model Residuals&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;residuals&lt;/code&gt; is a generic function which extracts model residuals&#10;from objects returned by modeling functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The abbreviated form &lt;code&gt;resid&lt;/code&gt; is an alias for &lt;code&gt;residuals&lt;/code&gt;.&#10;It is intended to encourage users to access object components through&#10;an accessor function rather than by directly referencing an object&#10;slot.&#10;&lt;/p&gt;&#10;&lt;p&gt;All object classes which are returned by model fitting functions&#10;should provide a &lt;code&gt;residuals&lt;/code&gt; method.  (Note that the method is&#10;for &lt;span class=&quot;samp&quot;&gt;residuals&lt;/span&gt; and not &lt;span class=&quot;samp&quot;&gt;resid&lt;/span&gt;.)&#10;&lt;/p&gt;&#10;&lt;p&gt;Methods can make use of &lt;code&gt;naresid&lt;/code&gt; methods to compensate&#10;for the omission of missing values.  The default, &lt;code&gt;nls&lt;/code&gt; and&#10;&lt;code&gt;smooth.spline&lt;/code&gt; methods do.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;residuals(object, ...)&#10;resid(object, ...)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;object&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an object for which the extraction of model residuals is&#10;meaningful.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;other arguments.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;Residuals extracted from the object &lt;code&gt;object&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Chambers, J. M. and Hastie, T. J. (1992)&#10;&lt;em&gt;Statistical Models in S&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;coefficients&lt;/code&gt;, &lt;code&gt;fitted.values&lt;/code&gt;,&#10;&lt;code&gt;glm&lt;/code&gt;, &lt;code&gt;lm&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;influence.measures for standardized (&lt;code&gt;rstandard&lt;/code&gt;)&#10;and studentized (&lt;code&gt;rstudent&lt;/code&gt;) residuals.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Extract Model Residuals&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for residuals&quot;&gt;&lt;tr&gt;&lt;td&gt;residuals&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Extract Model Residuals&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;residuals&lt;/code&gt; is a generic function which extracts model residuals&#10;from objects returned by modeling functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The abbreviated form &lt;code&gt;resid&lt;/code&gt; is an alias for &lt;code&gt;residuals&lt;/code&gt;.&#10;It is intended to encourage users to access object components through&#10;an accessor function rather than by directly referencing an object&#10;slot.&#10;&lt;/p&gt;&#10;&lt;p&gt;All object classes which are returned by model fitting functions&#10;should provide a &lt;code&gt;residuals&lt;/code&gt; method.  (Note that the method is&#10;for &lt;span class=&quot;samp&quot;&gt;residuals&lt;/span&gt; and not &lt;span class=&quot;samp&quot;&gt;resid&lt;/span&gt;.)&#10;&lt;/p&gt;&#10;&lt;p&gt;Methods can make use of &lt;code&gt;naresid&lt;/code&gt; methods to compensate&#10;for the omission of missing values.  The default, &lt;code&gt;nls&lt;/code&gt; and&#10;&lt;code&gt;smooth.spline&lt;/code&gt; methods do.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;residuals(object, ...)&#10;resid(object, ...)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;object&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an object for which the extraction of model residuals is&#10;meaningful.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;other arguments.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;Residuals extracted from the object &lt;code&gt;object&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Chambers, J. M. and Hastie, T. J. (1992)&#10;&lt;em&gt;Statistical Models in S&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;coefficients&lt;/code&gt;, &lt;code&gt;fitted.values&lt;/code&gt;,&#10;&lt;code&gt;glm&lt;/code&gt;, &lt;code&gt;lm&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;influence.measures for standardized (&lt;code&gt;rstandard&lt;/code&gt;)&#10;and studentized (&lt;code&gt;rstudent&lt;/code&gt;) residuals.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Accessing Generalized Linear Model Fits&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for glm.summaries&quot;&gt;&lt;tr&gt;&lt;td&gt;glm.summaries&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Accessing Generalized Linear Model Fits&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;These functions are all &lt;code&gt;methods&lt;/code&gt; for class &lt;code&gt;glm&lt;/code&gt; or&#10;&lt;code&gt;summary.glm&lt;/code&gt; objects.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;## S3 method for class &#39;glm&#39;&#10;family(object, ...)&#10;&#10;## S3 method for class &#39;glm&#39;&#10;residuals(object, type = c(&quot;deviance&quot;, &quot;pearson&quot;, &quot;working&quot;,&#10;                           &quot;response&quot;, &quot;partial&quot;), ...)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;object&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an object of class &lt;code&gt;glm&lt;/code&gt;, typically the result of&#10;a call to &lt;code&gt;glm&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;type&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the type of residuals which should be returned.&#10;The alternatives are: &lt;code&gt;&quot;deviance&quot;&lt;/code&gt; (default), &lt;code&gt;&quot;pearson&quot;&lt;/code&gt;,&#10;&lt;code&gt;&quot;working&quot;&lt;/code&gt;, &lt;code&gt;&quot;response&quot;&lt;/code&gt;, and &lt;code&gt;&quot;partial&quot;&lt;/code&gt;.&#10;Can be abbreviated.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;further arguments passed to or from other methods.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The references define the types of residuals: Davison &amp;amp; Snell is a&#10;good reference for the usages of each.&#10;&lt;/p&gt;&#10;&lt;p&gt;The partial residuals are a matrix of working residuals, with each&#10;column formed by omitting a term from the model.&#10;&lt;/p&gt;&#10;&lt;p&gt;How &lt;code&gt;residuals&lt;/code&gt; treats cases with missing values in the original&#10;fit is determined by the &lt;code&gt;na.action&lt;/code&gt; argument of that fit.&#10;If &lt;code&gt;na.action = na.omit&lt;/code&gt; omitted cases will not appear in the&#10;residuals, whereas if &lt;code&gt;na.action = na.exclude&lt;/code&gt; they will appear,&#10;with residual value &lt;code&gt;NA&lt;/code&gt;.  See also &lt;code&gt;naresid&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;For fits done with &lt;code&gt;y = FALSE&lt;/code&gt; the response values are computed&#10;from other components.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Davison, A. C. and Snell, E. J. (1991)&#10;&lt;em&gt;Residuals and diagnostics.&lt;/em&gt;  In: Statistical Theory&#10;and Modelling. In Honour of Sir David Cox, FRS, eds.&#10;Hinkley, D. V., Reid, N. and Snell, E. J., Chapman &amp;amp; Hall.&#10;&lt;/p&gt;&#10;&lt;p&gt;Hastie, T. J. and Pregibon, D. (1992)&#10;&lt;em&gt;Generalized linear models.&lt;/em&gt;&#10;Chapter 6 of &lt;em&gt;Statistical Models in S&lt;/em&gt;&#10;eds J. M. Chambers and T. J. Hastie, Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;McCullagh P. and Nelder, J. A. (1989)&#10;&lt;em&gt;Generalized Linear Models.&lt;/em&gt;&#10;London: Chapman and Hall.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;glm&lt;/code&gt; for computing &lt;code&gt;glm.obj&lt;/code&gt;, &lt;code&gt;anova.glm&lt;/code&gt;;&#10;the corresponding &lt;em&gt;generic&lt;/em&gt; functions, &lt;code&gt;summary.glm&lt;/code&gt;,&#10;&lt;code&gt;coef&lt;/code&gt;, &lt;code&gt;deviance&lt;/code&gt;,&#10;&lt;code&gt;df.residual&lt;/code&gt;,&#10;&lt;code&gt;effects&lt;/code&gt;, &lt;code&gt;fitted&lt;/code&gt;,&#10;&lt;code&gt;residuals&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;influence.measures for deletion diagnostics, including&#10;standardized (&lt;code&gt;rstandard&lt;/code&gt;)&#10;and studentized (&lt;code&gt;rstudent&lt;/code&gt;) residuals.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Accessing Linear Model Fits&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for lm.summaries&quot;&gt;&lt;tr&gt;&lt;td&gt;lm.summaries&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Accessing Linear Model Fits&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;All these functions are &lt;code&gt;methods&lt;/code&gt; for class &lt;code&gt;&quot;lm&quot;&lt;/code&gt;  objects.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;## S3 method for class &#39;lm&#39;&#10;family(object, ...)&#10;&#10;## S3 method for class &#39;lm&#39;&#10;formula(x, ...)&#10;&#10;## S3 method for class &#39;lm&#39;&#10;residuals(object,&#10;          type = c(&quot;working&quot;, &quot;response&quot;, &quot;deviance&quot;, &quot;pearson&quot;,&#10;                   &quot;partial&quot;),&#10;          ...)&#10;&#10;## S3 method for class &#39;lm&#39;&#10;labels(object, ...)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;object, x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an object inheriting from class &lt;code&gt;lm&lt;/code&gt;, usually&#10;the result of a call to &lt;code&gt;lm&lt;/code&gt; or &lt;code&gt;aov&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;further arguments passed to or from other methods.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;type&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the type of residuals which should be returned.  Can be abbreviated.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The generic accessor functions &lt;code&gt;coef&lt;/code&gt;, &lt;code&gt;effects&lt;/code&gt;,&#10;&lt;code&gt;fitted&lt;/code&gt; and &lt;code&gt;residuals&lt;/code&gt; can be used to extract&#10;various useful features of the value returned by &lt;code&gt;lm&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The working and response residuals are &amp;lsquo;observed - fitted&amp;rsquo;.  The&#10;deviance and pearson residuals are weighted residuals, scaled by the&#10;square root of the weights used in fitting.  The partial residuals&#10;are a matrix with each column formed by omitting a term from the&#10;model.  In all these, zero weight cases are never omitted (as opposed&#10;to the standardized &lt;code&gt;rstudent&lt;/code&gt; residuals, and the&#10;&lt;code&gt;weighted.residuals&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;How &lt;code&gt;residuals&lt;/code&gt; treats cases with missing values in the original&#10;fit is determined by the &lt;code&gt;na.action&lt;/code&gt; argument of that fit.&#10;If &lt;code&gt;na.action = na.omit&lt;/code&gt; omitted cases will not appear in the&#10;residuals, whereas if &lt;code&gt;na.action = na.exclude&lt;/code&gt; they will appear,&#10;with residual value &lt;code&gt;NA&lt;/code&gt;.  See also &lt;code&gt;naresid&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The &lt;code&gt;&quot;lm&quot;&lt;/code&gt; method for generic &lt;code&gt;labels&lt;/code&gt; returns the&#10;term labels for estimable terms, that is the names of the terms with&#10;an least one estimable coefficient.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Chambers, J. M. (1992)&#10;&lt;em&gt;Linear models.&lt;/em&gt;&#10;Chapter 4 of &lt;em&gt;Statistical Models in S&lt;/em&gt;&#10;eds J. M. Chambers and T. J. Hastie, Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;The model fitting function &lt;code&gt;lm&lt;/code&gt;, &lt;code&gt;anova.lm&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;coef&lt;/code&gt;, &lt;code&gt;deviance&lt;/code&gt;,&#10;&lt;code&gt;df.residual&lt;/code&gt;,&#10;&lt;code&gt;effects&lt;/code&gt;, &lt;code&gt;fitted&lt;/code&gt;,&#10;&lt;code&gt;glm&lt;/code&gt; for &lt;b&gt;generalized&lt;/b&gt; linear models,&#10;&lt;code&gt;influence&lt;/code&gt; (etc on that page) for regression diagnostics,&#10;&lt;code&gt;weighted.residuals&lt;/code&gt;,&#10;&lt;code&gt;residuals&lt;/code&gt;, &lt;code&gt;residuals.glm&lt;/code&gt;,&#10;&lt;code&gt;summary.lm&lt;/code&gt;, &lt;code&gt;weights&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;influence.measures for deletion diagnostics, including&#10;standardized (&lt;code&gt;rstandard&lt;/code&gt;)&#10;and studentized (&lt;code&gt;rstudent&lt;/code&gt;) residuals.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;&#10;##-- Continuing the  lm(.) example:&#10;coef(lm.D90) # the bare coefficients&#10;&#10;## The 2 basic regression diagnostic plots [plot.lm(.) is preferred]&#10;plot(resid(lm.D90), fitted(lm.D90)) # Tukey-Anscombe&#39;s&#10;abline(h = 0, lty = 2, col = &quot;gray&quot;)&#10;&#10;qqnorm(residuals(lm.D90))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Exponential Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Exponential&quot;&gt;&lt;tr&gt;&lt;td&gt;Exponential&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Exponential Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the exponential distribution with rate &lt;code&gt;rate&lt;/code&gt;&#10;(i.e., mean &lt;code&gt;1/rate&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dexp(x, rate = 1, log = FALSE)&#10;pexp(q, rate = 1, lower.tail = TRUE, log.p = FALSE)&#10;qexp(p, rate = 1, lower.tail = TRUE, log.p = FALSE)&#10;rexp(n, rate = 1)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;rate&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of rates.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;code&gt;rate&lt;/code&gt; is not specified, it assumes the default value of&#10;&lt;code&gt;1&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The exponential distribution with rate &lt;i&gt;&amp;lambda;&lt;/i&gt; has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = &amp;lambda; {e}^{- &amp;lambda; x}&lt;/i&gt;&lt;/p&gt;&#10;&lt;p&gt; for &lt;i&gt;x &amp;ge; 0&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dexp&lt;/code&gt; gives the density,&#10;&lt;code&gt;pexp&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qexp&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rexp&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rexp&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;The cumulative hazard &lt;i&gt;H(t) = - log(1 - F(t))&lt;/i&gt;&#10;is &lt;code&gt;-pexp(t, r, lower = FALSE, log = TRUE)&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dexp&lt;/code&gt;, &lt;code&gt;pexp&lt;/code&gt; and &lt;code&gt;qexp&lt;/code&gt; are all calculated&#10;from numerically stable versions of the definitions.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rexp&lt;/code&gt; uses&#10;&lt;/p&gt;&#10;&lt;p&gt;Ahrens, J. H. and Dieter, U. (1972).&#10;Computer methods for sampling from the exponential and normal distributions.&#10;&lt;em&gt;Communications of the ACM&lt;/em&gt;, &lt;b&gt;15&lt;/b&gt;, 873&amp;ndash;882.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 1, chapter 19.&#10;Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;exp&lt;/code&gt; for the exponential function.&#10;&lt;/p&gt;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dgamma&lt;/code&gt; for the gamma distribution and&#10;&lt;code&gt;dweibull&lt;/code&gt; for the Weibull distribution, both of which&#10;generalize the exponential.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dexp(1) - exp(-1) #-&amp;gt; 0&#10;&#10;## a fast way to generate *sorted*  U[0,1]  random numbers:&#10;rsunif &amp;lt;- function(n) { n1 &amp;lt;- n+1&#10;   cE &amp;lt;- cumsum(rexp(n1)); cE[seq_len(n)]/cE[n1] }&#10;plot(rsunif(1000), ylim=0:1, pch=&quot;.&quot;)&#10;abline(0,1/(1000+1), col=adjustcolor(1, 0.5))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The F Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for FDist&quot;&gt;&lt;tr&gt;&lt;td&gt;FDist&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The F Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the F distribution with &lt;code&gt;df1&lt;/code&gt; and &lt;code&gt;df2&lt;/code&gt;&#10;degrees of freedom (and optional non-centrality parameter &lt;code&gt;ncp&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;df(x, df1, df2, ncp, log = FALSE)&#10;pf(q, df1, df2, ncp, lower.tail = TRUE, log.p = FALSE)&#10;qf(p, df1, df2, ncp, lower.tail = TRUE, log.p = FALSE)&#10;rf(n, df1, df2, ncp)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;df1, df2&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;degrees of freedom.  &lt;code&gt;Inf&lt;/code&gt; is allowed.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;ncp&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;non-centrality parameter. If omitted the central F is assumed.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The F distribution with &lt;code&gt;df1 =&lt;/code&gt; &lt;i&gt;n1&lt;/i&gt; and &lt;code&gt;df2 =&lt;/code&gt;&#10;&lt;i&gt;n2&lt;/i&gt; degrees of freedom has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = &amp;Gamma;((n1 + n2)/2) / (&amp;Gamma;(n1/2) &amp;Gamma;(n2/2))&#10;    (n1/n2)^(n1/2) x^(n1/2 - 1)&#10;    (1 + (n1/n2) x)^-(n1 + n2)/2&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x &amp;gt; 0&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;It is the distribution of the ratio of the mean squares of&#10;&lt;i&gt;n1&lt;/i&gt; and &lt;i&gt;n2&lt;/i&gt; independent standard normals, and hence&#10;of the ratio of two independent chi-squared variates each divided by its&#10;degrees of freedom.  Since the ratio of a normal and the root&#10;mean-square of &lt;i&gt;m&lt;/i&gt; independent normals has a Student&#39;s &lt;i&gt;t_m&lt;/i&gt;&#10;distribution, the square of a &lt;i&gt;t_m&lt;/i&gt; variate has a F distribution on&#10;1 and &lt;i&gt;m&lt;/i&gt; degrees of freedom.&#10;&lt;/p&gt;&#10;&lt;p&gt;The non-central F distribution is again the ratio of mean squares of&#10;independent normals of unit variance, but those in the numerator are&#10;allowed to have non-zero means and &lt;code&gt;ncp&lt;/code&gt; is the sum of squares of&#10;the means.  See Chisquare for further details on&#10;non-central distributions.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;df&lt;/code&gt; gives the density,&#10;&lt;code&gt;pf&lt;/code&gt; gives the distribution function&#10;&lt;code&gt;qf&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rf&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid arguments will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rf&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;Supplying &lt;code&gt;ncp = 0&lt;/code&gt; uses the algorithm for the non-central&#10;distribution, which is not the same algorithm used if &lt;code&gt;ncp&lt;/code&gt; is&#10;omitted.  This is to give consistent behaviour in extreme cases with&#10;values of &lt;code&gt;ncp&lt;/code&gt; very near zero.&#10;&lt;/p&gt;&#10;&lt;p&gt;The code for non-zero &lt;code&gt;ncp&lt;/code&gt; is principally intended to be used&#10;for moderate values of &lt;code&gt;ncp&lt;/code&gt;: it will not be highly accurate,&#10;especially in the tails, for large values.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;For the central case of &lt;code&gt;df&lt;/code&gt;, computed &lt;em&gt;via&lt;/em&gt; a binomial&#10;probability, code contributed by Catherine Loader (see&#10;&lt;code&gt;dbinom&lt;/code&gt;); for the non-central case computed &lt;em&gt;via&lt;/em&gt;&#10;&lt;code&gt;dbeta&lt;/code&gt;, code contributed by Peter Ruckdeschel.&#10;&lt;/p&gt;&#10;&lt;p&gt;For &lt;code&gt;pf&lt;/code&gt;, &lt;em&gt;via&lt;/em&gt; &lt;code&gt;pbeta&lt;/code&gt; (or for large&#10;&lt;code&gt;df2&lt;/code&gt;, &lt;em&gt;via&lt;/em&gt; &lt;code&gt;pchisq&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;For &lt;code&gt;qf&lt;/code&gt;, &lt;em&gt;via&lt;/em&gt; &lt;code&gt;qchisq&lt;/code&gt; for large &lt;code&gt;df2&lt;/code&gt;,&#10;else &lt;em&gt;via&lt;/em&gt; &lt;code&gt;qbeta&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 2, chapters 27 and 30.&#10;Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dchisq&lt;/code&gt; for chi-squared and &lt;code&gt;dt&lt;/code&gt; for Student&#39;s&#10;t distributions.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;## Equivalence of pt(.,nu) with pf(.^2, 1,nu):&#10;x &amp;lt;- seq(0.001, 5, len = 100)&#10;nu &amp;lt;- 4&#10;stopifnot(all.equal(2*pt(x,nu) - 1, pf(x^2, 1,nu)),&#10;          ## upper tails:&#10; \t  all.equal(2*pt(x,     nu, lower=FALSE),&#10;\t\t      pf(x^2, 1,nu, lower=FALSE)))&#10;&#10;## the density of the square of a t_m is 2*dt(x, m)/(2*x)&#10;# check this is the same as the density of F_{1,m}&#10;all.equal(df(x^2, 1, 5), dt(x, 5)/x)&#10;&#10;## Identity:  qf(2*p - 1, 1, df) == qt(p, df)^2  for  p &amp;gt;= 1/2&#10;p &amp;lt;- seq(1/2, .99, length = 50); df &amp;lt;- 10&#10;rel.err &amp;lt;- function(x, y) ifelse(x == y, 0, abs(x-y)/mean(abs(c(x,y))))&#10;quantile(rel.err(qf(2*p - 1, df1 = 1, df2 = df), qt(p, df)^2), .90)  # ~= 7e-9&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Gamma Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for GammaDist&quot;&gt;&lt;tr&gt;&lt;td&gt;GammaDist&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Gamma Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the Gamma distribution with parameters &lt;code&gt;shape&lt;/code&gt; and&#10;&lt;code&gt;scale&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dgamma(x, shape, rate = 1, scale = 1/rate, log = FALSE)&#10;pgamma(q, shape, rate = 1, scale = 1/rate, lower.tail = TRUE,&#10;       log.p = FALSE)&#10;qgamma(p, shape, rate = 1, scale = 1/rate, lower.tail = TRUE,&#10;       log.p = FALSE)&#10;rgamma(n, shape, rate = 1, scale = 1/rate)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;rate&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an alternative way to specify the scale.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;shape, scale&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;shape and scale parameters.  Must be positive,&#10;&lt;code&gt;scale&lt;/code&gt; strictly.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if &lt;code&gt;TRUE&lt;/code&gt;, probabilities/densities &lt;i&gt;p&lt;/i&gt;&#10;are returned as &lt;i&gt;log(p)&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;code&gt;scale&lt;/code&gt; is omitted, it assumes the default value of &lt;code&gt;1&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The Gamma distribution with parameters &lt;code&gt;shape&lt;/code&gt; &lt;i&gt;= a&lt;/i&gt;&#10;and &lt;code&gt;scale&lt;/code&gt; &lt;i&gt;= s&lt;/i&gt; has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x)= 1/(s^a Gamma(a)) x^(a-1) e^-(x/s)&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x &amp;ge; 0&lt;/i&gt;, &lt;i&gt;a &amp;gt; 0&lt;/i&gt; and &lt;i&gt;s &amp;gt; 0&lt;/i&gt;.&#10;(Here &lt;i&gt;Gamma(a)&lt;/i&gt; is the function implemented by &lt;span style=&quot;font-family: Courier New, Courier; color: #666666;&quot;&gt;&lt;b&gt;R&lt;/b&gt;&lt;/span&gt;&#39;s&#10;&lt;code&gt;gamma()&lt;/code&gt; and defined in its help.  Note that &lt;i&gt;a = 0&lt;/i&gt;&#10;corresponds to the trivial distribution with all mass at point 0.)&#10;&lt;/p&gt;&#10;&lt;p&gt;The mean and variance are&#10;&lt;i&gt;E(X) = a*s&lt;/i&gt; and&#10;&lt;i&gt;Var(X) = a*s^2&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The cumulative hazard &lt;i&gt;H(t) = - log(1 - F(t))&lt;/i&gt;&#10;is&#10;&lt;/p&gt;&#10;&lt;pre&gt;-pgamma(t, ..., lower = FALSE, log = TRUE)&#10;&lt;/pre&gt;&#10;&lt;p&gt;Note that for smallish values of &lt;code&gt;shape&lt;/code&gt; (and moderate&#10;&lt;code&gt;scale&lt;/code&gt;) a large parts of the mass of the Gamma distribution is&#10;on values of &lt;i&gt;x&lt;/i&gt; so near zero that they will be represented as&#10;zero in computer arithmetic.  So &lt;code&gt;rgamma&lt;/code&gt; may well return values&#10;which will be represented as zero.  (This will also happen for very&#10;large values of &lt;code&gt;scale&lt;/code&gt; since the actual generation is done for&#10;&lt;code&gt;scale = 1&lt;/code&gt;.)&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dgamma&lt;/code&gt; gives the density,&#10;&lt;code&gt;pgamma&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qgamma&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rgamma&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid arguments will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rgamma&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;The S (Becker &lt;em&gt;et al&lt;/em&gt;, 1988) parametrization was via &lt;code&gt;shape&lt;/code&gt;&#10;and &lt;code&gt;rate&lt;/code&gt;: S had no &lt;code&gt;scale&lt;/code&gt; parameter. It is an error&#10;to supply and &lt;code&gt;scale&lt;/code&gt; and &lt;code&gt;rate&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;pgamma&lt;/code&gt; is closely related to the incomplete gamma function.  As&#10;defined by Abramowitz and Stegun 6.5.1 (and by &amp;lsquo;Numerical&#10;Recipes&amp;rsquo;) this is&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;P(a,x) = 1/Gamma(a) integral_0^x t^(a-1) exp(-t) dt&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;&lt;i&gt;P(a, x)&lt;/i&gt; is &lt;code&gt;pgamma(x, a)&lt;/code&gt;.  Other authors (for example&#10;Karl Pearson in his 1922 tables) omit the normalizing factor,&#10;defining the incomplete gamma function &lt;i&gt;&amp;gamma;(a,x)&lt;/i&gt; as&#10;&lt;i&gt;gamma(a,x) =&#10;    integral_0^x t^(a-1) exp(-t) dt,&lt;/i&gt; i.e., &lt;code&gt;pgamma(x, a) * gamma(a)&lt;/code&gt;.&#10;Yet other use the &amp;lsquo;upper&amp;rsquo; incomplete gamma function,&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;Gamma(a,x) = integral_x^Inf t^(a-1) exp(-t) dt,&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;which can be computed by&#10;&lt;code&gt;pgamma(x, a, lower = FALSE) * gamma(a)&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Note however that &lt;code&gt;pgamma(x, a, ..)&lt;/code&gt; currently requires &lt;i&gt;a &amp;gt; 0&lt;/i&gt;,&#10;whereas the incomplete gamma function is also defined for negative&#10;&lt;i&gt;a&lt;/i&gt;.  In that case, you can use &lt;code&gt;gamma_inc(a,x)&lt;/code&gt; (for&#10;&lt;i&gt;&amp;Gamma;(a,x)&lt;/i&gt;) from package &lt;a href=&quot;https://CRAN.R-project.org/package=gsl&quot;&gt;&lt;span class=&quot;pkg&quot;&gt;gsl&lt;/span&gt;&lt;/a&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;See also&#10;&lt;a href=&quot;https://en.wikipedia.org/wiki/Incomplete_gamma_function&quot;&gt;https://en.wikipedia.org/wiki/Incomplete_gamma_function&lt;/a&gt;, or&#10;&lt;a href=&quot;https://dlmf.nist.gov/8.2#i&quot;&gt;https://dlmf.nist.gov/8.2#i&lt;/a&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dgamma&lt;/code&gt; is computed via the Poisson density, using code contributed&#10;by Catherine Loader (see &lt;code&gt;dbinom&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;pgamma&lt;/code&gt; uses an unpublished (and not otherwise documented)&#10;algorithm &amp;lsquo;mainly by Morten Welinder&amp;rsquo;.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;qgamma&lt;/code&gt; is based on a C translation of&#10;&lt;/p&gt;&#10;&lt;p&gt;Best, D. J. and D. E. Roberts (1975).&#10;Algorithm AS91. Percentage points of the chi-squared distribution.&#10;&lt;em&gt;Applied Statistics&lt;/em&gt;,  &lt;b&gt;24&lt;/b&gt;, 385&amp;ndash;388.&#10;&lt;/p&gt;&#10;&lt;p&gt;plus a final Newton step to improve the approximation.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rgamma&lt;/code&gt; for &lt;code&gt;shape &amp;gt;= 1&lt;/code&gt; uses&#10;&lt;/p&gt;&#10;&lt;p&gt;Ahrens, J. H. and Dieter, U. (1982).&#10;Generating gamma variates by a modified rejection technique.&#10;&lt;em&gt;Communications of the ACM&lt;/em&gt;, &lt;b&gt;25&lt;/b&gt;, 47&amp;ndash;54,&#10;&lt;/p&gt;&#10;&lt;p&gt;and for &lt;code&gt;0 &amp;lt; shape &amp;lt; 1&lt;/code&gt; uses&#10;&lt;/p&gt;&#10;&lt;p&gt;Ahrens, J. H. and Dieter, U. (1974).&#10;Computer methods for sampling from gamma, beta, Poisson and binomial&#10;distributions. &lt;em&gt;Computing&lt;/em&gt;, &lt;b&gt;12&lt;/b&gt;, 223&amp;ndash;246.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988).&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Shea, B. L. (1988).&#10;Algorithm AS 239: Chi-squared and incomplete Gamma integral,&#10;&lt;em&gt;Applied Statistics (JRSS C)&lt;/em&gt;, &lt;b&gt;37&lt;/b&gt;, 466&amp;ndash;473.&#10;doi: &lt;a href=&quot;https://doi.org/10.2307/2347328&quot;&gt;10.2307/2347328&lt;/a&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Abramowitz, M. and Stegun, I. A. (1972)&#10;&lt;em&gt;Handbook of Mathematical Functions.&lt;/em&gt; New York: Dover.&#10;Chapter 6: Gamma and Related Functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;NIST Digital Library of Mathematical Functions.&#10;&lt;a href=&quot;https://dlmf.nist.gov/&quot;&gt;https://dlmf.nist.gov/&lt;/a&gt;, section 8.2.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;gamma&lt;/code&gt; for the gamma function.&#10;&lt;/p&gt;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dbeta&lt;/code&gt; for the Beta distribution and &lt;code&gt;dchisq&lt;/code&gt;&#10;for the chi-squared distribution which is a special case of the Gamma&#10;distribution.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;-log(dgamma(1:4, shape = 1))&#10;p &amp;lt;- (1:9)/10&#10;pgamma(qgamma(p, shape = 2), shape = 2)&#10;1 - 1/exp(qgamma(p, shape = 1))&#10;&#10;# even for shape = 0.001 about half the mass is on numbers&#10;# that cannot be represented accurately (and most of those as zero)&#10;pgamma(.Machine$double.xmin, 0.001)&#10;pgamma(5e-324, 0.001)  # on most machines 5e-324 is the smallest&#10;                       # representable non-zero number&#10;table(rgamma(1e4, 0.001) == 0)/1e4&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Geometric Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Geometric&quot;&gt;&lt;tr&gt;&lt;td&gt;Geometric&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Geometric Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the geometric distribution with parameter &lt;code&gt;prob&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dgeom(x, prob, log = FALSE)&#10;pgeom(q, prob, lower.tail = TRUE, log.p = FALSE)&#10;qgeom(p, prob, lower.tail = TRUE, log.p = FALSE)&#10;rgeom(n, prob)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles representing the number of failures in&#10;a sequence of Bernoulli trials before success occurs.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;prob&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;probability of success in each trial. &lt;code&gt;0 &amp;lt; prob &amp;lt;= 1&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The geometric distribution with &lt;code&gt;prob&lt;/code&gt; &lt;i&gt;= p&lt;/i&gt; has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;p(x) = p (1-p)^x&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x = 0, 1, 2, &amp;hellip;&lt;/i&gt;, &lt;i&gt;0 &amp;lt; p &amp;le; 1&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;If an element of &lt;code&gt;x&lt;/code&gt; is not integer, the result of &lt;code&gt;dgeom&lt;/code&gt;&#10;is zero, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The quantile is defined as the smallest value &lt;i&gt;x&lt;/i&gt; such that&#10;&lt;i&gt;F(x) &amp;ge; p&lt;/i&gt;, where &lt;i&gt;F&lt;/i&gt; is the distribution function.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dgeom&lt;/code&gt; gives the density,&#10;&lt;code&gt;pgeom&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qgeom&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rgeom&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid &lt;code&gt;prob&lt;/code&gt; will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rgeom&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rgeom&lt;/code&gt; returns a vector of type integer unless generated&#10;values exceed the maximum representable integer when &lt;code&gt;double&lt;/code&gt;&#10;values are returned since R version 4.0.0.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dgeom&lt;/code&gt; computes via &lt;code&gt;dbinom&lt;/code&gt;, using code contributed by&#10;Catherine Loader (see &lt;code&gt;dbinom&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;pgeom&lt;/code&gt; and &lt;code&gt;qgeom&lt;/code&gt; are based on the closed-form formulae.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rgeom&lt;/code&gt; uses the derivation as an exponential mixture of Poissons, see&#10;&lt;/p&gt;&#10;&lt;p&gt;Devroye, L. (1986) &lt;em&gt;Non-Uniform Random Variate Generation.&lt;/em&gt;&#10;Springer-Verlag, New York. Page 480.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dnbinom&lt;/code&gt; for the negative binomial which generalizes&#10;the geometric distribution.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;qgeom((1:9)/10, prob = .2)&#10;Ni &amp;lt;- rgeom(20, prob = 1/4); table(factor(Ni, 0:max(Ni)))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Hypergeometric Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Hypergeometric&quot;&gt;&lt;tr&gt;&lt;td&gt;Hypergeometric&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Hypergeometric Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the hypergeometric distribution.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dhyper(x, m, n, k, log = FALSE)&#10;phyper(q, m, n, k, lower.tail = TRUE, log.p = FALSE)&#10;qhyper(p, m, n, k, lower.tail = TRUE, log.p = FALSE)&#10;rhyper(nn, m, n, k)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles representing the number of white balls&#10;drawn without replacement from an urn which contains both black and&#10;white balls.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;m&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the number of white balls in the urn.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the number of black balls in the urn.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;k&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the number of balls drawn from the urn, hence must be in&#10;&lt;i&gt;0,1,&amp;hellip;, m+n&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;probability, it must be between 0 and 1.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;nn&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations.  If &lt;code&gt;length(nn) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The hypergeometric distribution is used for sampling &lt;em&gt;without&lt;/em&gt;&#10;replacement.  The density of this distribution with parameters&#10;&lt;code&gt;m&lt;/code&gt;, &lt;code&gt;n&lt;/code&gt; and &lt;code&gt;k&lt;/code&gt; (named &lt;i&gt;Np&lt;/i&gt;, &lt;i&gt;N-Np&lt;/i&gt;, and&#10;&lt;i&gt;n&lt;/i&gt;, respectively in the reference below, where &lt;i&gt;N := m+n&lt;/i&gt; is also used&#10;in other references) is given by&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;p(x) =      choose(m, x) choose(n, k-x) / choose(m+n, k)&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x = 0, &amp;hellip;, k&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that &lt;i&gt;p(x)&lt;/i&gt; is non-zero only for&#10;&lt;i&gt;max(0, k-n) &amp;lt;= x &amp;lt;= min(k, m)&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;With &lt;i&gt;p := m/(m+n)&lt;/i&gt; (hence &lt;i&gt;Np = N \\times p&lt;/i&gt; in the&#10;reference&#39;s notation), the first two moments are mean&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;E[X] = &amp;mu; = k p&lt;/i&gt;&lt;/p&gt;&#10;&lt;p&gt; and variance&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;&#10;               Var(X) = k p (1 - p) * (m+n-k)/(m+n-1),&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;which shows the closeness to the Binomial&lt;i&gt;(k,p)&lt;/i&gt; (where the&#10;hypergeometric has smaller variance unless &lt;i&gt;k = 1&lt;/i&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;The quantile is defined as the smallest value &lt;i&gt;x&lt;/i&gt; such that&#10;&lt;i&gt;F(x) &amp;ge; p&lt;/i&gt;, where &lt;i&gt;F&lt;/i&gt; is the distribution function.&#10;&lt;/p&gt;&#10;&lt;p&gt;In &lt;code&gt;rhyper()&lt;/code&gt;, if one of &lt;i&gt;m, n, k&lt;/i&gt; exceeds &lt;code&gt;.Machine$integer.max&lt;/code&gt;,&#10;currently the equivalent of &lt;code&gt;qhyper(runif(nn), m,n,k)&lt;/code&gt; is used&#10;which is comparably slow while instead a binomial approximation may be&#10;considerably more efficient.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dhyper&lt;/code&gt; gives the density,&#10;&lt;code&gt;phyper&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qhyper&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rhyper&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid arguments will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rhyper&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dhyper&lt;/code&gt; computes via binomial probabilities, using code&#10;contributed by Catherine Loader (see &lt;code&gt;dbinom&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;phyper&lt;/code&gt; is based on calculating &lt;code&gt;dhyper&lt;/code&gt; and&#10;&lt;code&gt;phyper(...)/dhyper(...)&lt;/code&gt; (as a summation), based on ideas of Ian&#10;Smith and Morten Welinder.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;qhyper&lt;/code&gt; is based on inversion (of an earlier &lt;code&gt;phyper()&lt;/code&gt; algorithm).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rhyper&lt;/code&gt; is based on a corrected version of&#10;&lt;/p&gt;&#10;&lt;p&gt;Kachitvichyanukul, V. and Schmeiser, B. (1985).&#10;Computer generation of hypergeometric random variates.&#10;&lt;em&gt;Journal of Statistical Computation and Simulation&lt;/em&gt;,&#10;&lt;b&gt;22&lt;/b&gt;, 127&amp;ndash;145.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Johnson, N. L., Kotz, S., and Kemp, A. W. (1992)&#10;&lt;em&gt;Univariate Discrete Distributions&lt;/em&gt;,&#10;Second Edition. New York: Wiley.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;m &amp;lt;- 10; n &amp;lt;- 7; k &amp;lt;- 8&#10;x &amp;lt;- 0:(k+1)&#10;rbind(phyper(x, m, n, k), dhyper(x, m, n, k))&#10;all(phyper(x, m, n, k) == cumsum(dhyper(x, m, n, k)))  # FALSE&#10;## but error is very small:&#10;signif(phyper(x, m, n, k) - cumsum(dhyper(x, m, n, k)), digits = 3)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Log Normal Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Lognormal&quot;&gt;&lt;tr&gt;&lt;td&gt;Lognormal&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Log Normal Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the log normal distribution whose logarithm has mean&#10;equal to &lt;code&gt;meanlog&lt;/code&gt; and standard deviation equal to &lt;code&gt;sdlog&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dlnorm(x, meanlog = 0, sdlog = 1, log = FALSE)&#10;plnorm(q, meanlog = 0, sdlog = 1, lower.tail = TRUE, log.p = FALSE)&#10;qlnorm(p, meanlog = 0, sdlog = 1, lower.tail = TRUE, log.p = FALSE)&#10;rlnorm(n, meanlog = 0, sdlog = 1)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;meanlog, sdlog&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;mean and standard deviation of the distribution&#10;on the log scale with default values of &lt;code&gt;0&lt;/code&gt; and &lt;code&gt;1&lt;/code&gt; respectively.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The log normal distribution has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = 1/(&amp;radic;(2 &amp;pi;) &amp;sigma; x) e^-((log x - &amp;mu;)^2 / (2 &amp;sigma;^2))&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;where &lt;i&gt;&amp;mu;&lt;/i&gt; and &lt;i&gt;&amp;sigma;&lt;/i&gt; are the mean and standard&#10;deviation of the logarithm.&#10;The mean is &lt;i&gt;E(X) = exp(&amp;mu; + 1/2 &amp;sigma;^2)&lt;/i&gt;,&#10;the median is &lt;i&gt;med(X) = exp(&amp;mu;)&lt;/i&gt;, and the variance&#10;&lt;i&gt;Var(X) = exp(2*&amp;mu; + &amp;sigma;^2)*(exp(&amp;sigma;^2) - 1)&lt;/i&gt;&#10;and hence the coefficient of variation is&#10;&lt;i&gt;sqrt(exp(&amp;sigma;^2) - 1)&lt;/i&gt; which is&#10;approximately &lt;i&gt;&amp;sigma;&lt;/i&gt; when that is small (e.g., &lt;i&gt;&amp;sigma; &amp;lt; 1/2&lt;/i&gt;).&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dlnorm&lt;/code&gt; gives the density,&#10;&lt;code&gt;plnorm&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qlnorm&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rlnorm&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rlnorm&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;The cumulative hazard &lt;i&gt;H(t) = - log(1 - F(t))&lt;/i&gt;&#10;is &lt;code&gt;-plnorm(t, r, lower = FALSE, log = TRUE)&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dlnorm&lt;/code&gt; is calculated from the definition (in &amp;lsquo;Details&amp;rsquo;).&#10;&lt;code&gt;[pqr]lnorm&lt;/code&gt; are based on the relationship to the normal.&#10;&lt;/p&gt;&#10;&lt;p&gt;Consequently, they model a single point mass at &lt;code&gt;exp(meanlog)&lt;/code&gt;&#10;for the boundary case &lt;code&gt;sdlog = 0&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 1, chapter 14.&#10;Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dnorm&lt;/code&gt; for the normal distribution.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dlnorm(1) == dnorm(0)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Logistic Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Logistic&quot;&gt;&lt;tr&gt;&lt;td&gt;Logistic&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Logistic Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the logistic distribution with parameters&#10;&lt;code&gt;location&lt;/code&gt; and &lt;code&gt;scale&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dlogis(x, location = 0, scale = 1, log = FALSE)&#10;plogis(q, location = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)&#10;qlogis(p, location = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)&#10;rlogis(n, location = 0, scale = 1)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;location, scale&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;location and scale parameters.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;code&gt;location&lt;/code&gt; or &lt;code&gt;scale&lt;/code&gt; are omitted, they assume the&#10;default values of &lt;code&gt;0&lt;/code&gt; and &lt;code&gt;1&lt;/code&gt; respectively.&#10;&lt;/p&gt;&#10;&lt;p&gt;The Logistic distribution with &lt;code&gt;location&lt;/code&gt; &lt;i&gt;= m&lt;/i&gt; and&#10;&lt;code&gt;scale&lt;/code&gt; &lt;i&gt;= s&lt;/i&gt; has distribution function&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;F(x) = 1 / (1 + exp(-(x-m)/s))&lt;/i&gt;&lt;/p&gt;&#10;&lt;p&gt;  and density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = 1/s exp((x-m)/s) (1 + exp((x-m)/s))^-2.&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;It is a long-tailed distribution with mean &lt;i&gt;m&lt;/i&gt; and variance&#10;&lt;i&gt;&amp;pi;^2 /3 s^2&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dlogis&lt;/code&gt; gives the density,&#10;&lt;code&gt;plogis&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qlogis&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rlogis&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rlogis&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;qlogis(p)&lt;/code&gt; is the same as the well known &amp;lsquo;&lt;em&gt;logit&lt;/em&gt;&amp;rsquo;&#10;function, &lt;i&gt;logit(p) = log(p/(1-p))&lt;/i&gt;,&#10;and &lt;code&gt;plogis(x)&lt;/code&gt; has consequently been called the &amp;lsquo;inverse logit&amp;rsquo;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The distribution function is a rescaled hyperbolic tangent,&#10;&lt;code&gt;plogis(x) == (1+ tanh(x/2))/2&lt;/code&gt;, and it is called a&#10;&lt;em&gt;sigmoid function&lt;/em&gt; in contexts such as neural networks.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;[dpq]logis&lt;/code&gt; are calculated directly from the definitions.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rlogis&lt;/code&gt; uses inversion.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 2, chapter 23.&#10;Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;var(rlogis(4000, 0, scale = 5))  # approximately (+/- 3)&#10;pi^2/3 * 5^2&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Multinomial Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Multinom&quot;&gt;&lt;tr&gt;&lt;td&gt;Multinom&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Multinomial Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Generate multinomially distributed random number vectors and&#10;compute multinomial probabilities.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;rmultinom(n, size, prob)&#10;dmultinom(x, size = NULL, prob, log = FALSE)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of length &lt;i&gt;K&lt;/i&gt; of integers in &lt;code&gt;0:size&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of random vectors to draw.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;size&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;integer, say &lt;i&gt;N&lt;/i&gt;, specifying the total number&#10;of objects that are put into &lt;i&gt;K&lt;/i&gt; boxes in the typical multinomial&#10;experiment. For &lt;code&gt;dmultinom&lt;/code&gt;, it defaults to &lt;code&gt;sum(x)&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;prob&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;numeric non-negative vector of length &lt;i&gt;K&lt;/i&gt;, specifying&#10;the probability for the &lt;i&gt;K&lt;/i&gt; classes; is internally normalized to&#10;sum 1. Infinite and missing values are not allowed.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, log probabilities are computed.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;code&gt;x&lt;/code&gt; is a &lt;i&gt;K&lt;/i&gt;-component vector, &lt;code&gt;dmultinom(x, prob)&lt;/code&gt;&#10;is the probability&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;P(X[1]=x[1], &amp;hellip; , X[K]=x[k]) = C * prod(j=1 , &amp;hellip;, K) p[j]^x[j]&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;where &lt;i&gt;C&lt;/i&gt; is the &amp;lsquo;multinomial coefficient&amp;rsquo;&#10;&lt;i&gt;C = N! / (x[1]! * &amp;hellip; * x[K]!)&lt;/i&gt;&#10;and &lt;i&gt;N = sum(j=1, &amp;hellip;, K) x[j]&lt;/i&gt;.&#10;&lt;br /&gt;&#10;By definition, each component &lt;i&gt;X[j]&lt;/i&gt; is binomially distributed as&#10;&lt;code&gt;Bin(size, prob[j])&lt;/code&gt; for &lt;i&gt;j = 1, &amp;hellip;, K&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The &lt;code&gt;rmultinom()&lt;/code&gt; algorithm draws binomials &lt;i&gt;X[j]&lt;/i&gt; from&#10;&lt;i&gt;Bin(n[j], P[j])&lt;/i&gt; sequentially, where&#10;&lt;i&gt;n[1] = N&lt;/i&gt; (N := &lt;code&gt;size&lt;/code&gt;),&#10;&lt;i&gt;P[1] = p[1]&lt;/i&gt; (&lt;i&gt;p&lt;/i&gt; is &lt;code&gt;prob&lt;/code&gt; scaled to sum 1),&#10;and for &lt;i&gt;j &amp;ge; 2&lt;/i&gt;, recursively,&#10;&lt;i&gt;n[j] = N - sum(k=1, &amp;hellip;, j-1) X[k]&lt;/i&gt;&#10;and&#10;&lt;i&gt;P[j] = p[j] / (1 - sum(p[1:(j-1)]))&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;For &lt;code&gt;rmultinom()&lt;/code&gt;,&#10;an integer &lt;i&gt;K x n&lt;/i&gt; matrix where each column is a&#10;random vector generated according to the desired multinomial law, and&#10;hence summing to &lt;code&gt;size&lt;/code&gt;.  Whereas the &lt;em&gt;transposed&lt;/em&gt; result&#10;would seem more natural at first, the returned matrix is more&#10;efficient because of columnwise storage.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dmultinom&lt;/code&gt; is currently &lt;em&gt;not vectorized&lt;/em&gt; at all and has&#10;no C interface (API); this may be amended in the future.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for standard distributions, including&#10;&lt;code&gt;dbinom&lt;/code&gt; which is a special case conceptually.&#10;&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;rmultinom(10, size = 12, prob = c(0.1,0.2,0.8))&#10;&#10;pr &amp;lt;- c(1,3,6,10) # normalization not necessary for generation&#10;rmultinom(10, 20, prob = pr)&#10;&#10;## all possible outcomes of Multinom(N = 3, K = 3)&#10;X &amp;lt;- t(as.matrix(expand.grid(0:3, 0:3))); X &amp;lt;- X[, colSums(X) &amp;lt;= 3]&#10;X &amp;lt;- rbind(X, 3:3 - colSums(X)); dimnames(X) &amp;lt;- list(letters[1:3], NULL)&#10;X&#10;round(apply(X, 2, function(x) dmultinom(x, prob = c(1,2,5))), 3)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Negative Binomial Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for NegBinomial&quot;&gt;&lt;tr&gt;&lt;td&gt;NegBinomial&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Negative Binomial Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the negative binomial distribution with parameters&#10;&lt;code&gt;size&lt;/code&gt; and &lt;code&gt;prob&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dnbinom(x, size, prob, mu, log = FALSE)&#10;pnbinom(q, size, prob, mu, lower.tail = TRUE, log.p = FALSE)&#10;qnbinom(p, size, prob, mu, lower.tail = TRUE, log.p = FALSE)&#10;rnbinom(n, size, prob, mu)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of (non-negative integer) quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations.  If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;size&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;target for number of successful trials, or dispersion&#10;parameter (the shape parameter of the gamma mixing distribution).&#10;Must be strictly positive, need not be integer.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;prob&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;probability of success in each trial. &lt;code&gt;0 &amp;lt; prob &amp;lt;= 1&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;mu&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;alternative parametrization via mean: see &amp;lsquo;Details&amp;rsquo;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The negative binomial distribution with &lt;code&gt;size&lt;/code&gt; &lt;i&gt;= n&lt;/i&gt; and&#10;&lt;code&gt;prob&lt;/code&gt; &lt;i&gt;= p&lt;/i&gt; has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;&#10;    &amp;Gamma;(x+n)/(&amp;Gamma;(n) x!) p^n (1-p)^x&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x = 0, 1, 2, &amp;hellip;&lt;/i&gt;, &lt;i&gt;n &amp;gt; 0&lt;/i&gt; and &lt;i&gt;0 &amp;lt; p &amp;le; 1&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;This represents the number of failures which occur in a sequence of&#10;Bernoulli trials before a target number of successes is reached.&#10;The mean is &lt;i&gt;&amp;mu; = n(1-p)/p&lt;/i&gt; and variance &lt;i&gt;n(1-p)/p^2&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;A negative binomial distribution can also arise as a mixture of&#10;Poisson distributions with mean distributed as a gamma distribution&#10;(see &lt;code&gt;pgamma&lt;/code&gt;) with scale parameter &lt;code&gt;(1 - prob)/prob&lt;/code&gt;&#10;and shape parameter &lt;code&gt;size&lt;/code&gt;.  (This definition allows non-integer&#10;values of &lt;code&gt;size&lt;/code&gt;.)&#10;&lt;/p&gt;&#10;&lt;p&gt;An alternative parametrization (often used in ecology) is by the&#10;&lt;em&gt;mean&lt;/em&gt; &lt;code&gt;mu&lt;/code&gt; (see above), and &lt;code&gt;size&lt;/code&gt;, the &lt;em&gt;dispersion&#10;parameter&lt;/em&gt;, where &lt;code&gt;prob&lt;/code&gt; = &lt;code&gt;size/(size+mu)&lt;/code&gt;.  The variance&#10;is &lt;code&gt;mu + mu^2/size&lt;/code&gt; in this parametrization.&#10;&lt;/p&gt;&#10;&lt;p&gt;If an element of &lt;code&gt;x&lt;/code&gt; is not integer, the result of &lt;code&gt;dnbinom&lt;/code&gt;&#10;is zero, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The case &lt;code&gt;size == 0&lt;/code&gt; is the distribution concentrated at zero.&#10;This is the limiting distribution for &lt;code&gt;size&lt;/code&gt; approaching zero,&#10;even if &lt;code&gt;mu&lt;/code&gt; rather than &lt;code&gt;prob&lt;/code&gt; is held constant.  Notice&#10;though, that the mean of the limit distribution is 0, whatever the&#10;value of &lt;code&gt;mu&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The quantile is defined as the smallest value &lt;i&gt;x&lt;/i&gt; such that&#10;&lt;i&gt;F(x) &amp;ge; p&lt;/i&gt;, where &lt;i&gt;F&lt;/i&gt; is the distribution function.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dnbinom&lt;/code&gt; gives the density,&#10;&lt;code&gt;pnbinom&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qnbinom&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rnbinom&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid &lt;code&gt;size&lt;/code&gt; or &lt;code&gt;prob&lt;/code&gt; will result in return value&#10;&lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rnbinom&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rnbinom&lt;/code&gt; returns a vector of type integer unless generated&#10;values exceed the maximum representable integer when &lt;code&gt;double&lt;/code&gt;&#10;values are returned since R version 4.0.0.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dnbinom&lt;/code&gt; computes via binomial probabilities, using code&#10;contributed by Catherine Loader (see &lt;code&gt;dbinom&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;pnbinom&lt;/code&gt; uses &lt;code&gt;pbeta&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;qnbinom&lt;/code&gt; uses the Cornish&amp;ndash;Fisher Expansion to include a skewness&#10;correction to a normal approximation, followed by a search.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rnbinom&lt;/code&gt; uses the derivation as a gamma mixture of Poissons, see&#10;&lt;/p&gt;&#10;&lt;p&gt;Devroye, L. (1986) &lt;em&gt;Non-Uniform Random Variate Generation.&lt;/em&gt;&#10;Springer-Verlag, New York. Page 480.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for standard distributions, including&#10;&lt;code&gt;dbinom&lt;/code&gt; for the binomial, &lt;code&gt;dpois&lt;/code&gt; for the&#10;Poisson and &lt;code&gt;dgeom&lt;/code&gt; for the geometric distribution, which&#10;is a special case of the negative binomial.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;x &amp;lt;- 0:11&#10;dnbinom(x, size = 1, prob = 1/2) * 2^(1 + x) # == 1&#10;126 /  dnbinom(0:8, size  = 2, prob  = 1/2) #- theoretically integer&#10;&#10;## Cumulative (&#39;p&#39;) = Sum of discrete prob.s (&#39;d&#39;);  Relative error :&#10;summary(1 - cumsum(dnbinom(x, size = 2, prob = 1/2)) /&#10;                  pnbinom(x, size  = 2, prob = 1/2))&#10;&#10;x &amp;lt;- 0:15&#10;size &amp;lt;- (1:20)/4&#10;persp(x, size, dnb &amp;lt;- outer(x, size, function(x,s) dnbinom(x, s, prob = 0.4)),&#10;      xlab = &quot;x&quot;, ylab = &quot;s&quot;, zlab = &quot;density&quot;, theta = 150)&#10;title(tit &amp;lt;- &quot;negative binomial density(x,s, pr = 0.4)  vs.  x &amp;amp; s&quot;)&#10;&#10;image  (x, size, log10(dnb), main = paste(&quot;log [&quot;, tit, &quot;]&quot;))&#10;contour(x, size, log10(dnb), add = TRUE)&#10;&#10;## Alternative parametrization&#10;x1 &amp;lt;- rnbinom(500, mu = 4, size = 1)&#10;x2 &amp;lt;- rnbinom(500, mu = 4, size = 10)&#10;x3 &amp;lt;- rnbinom(500, mu = 4, size = 100)&#10;h1 &amp;lt;- hist(x1, breaks = 20, plot = FALSE)&#10;h2 &amp;lt;- hist(x2, breaks = h1$breaks, plot = FALSE)&#10;h3 &amp;lt;- hist(x3, breaks = h1$breaks, plot = FALSE)&#10;barplot(rbind(h1$counts, h2$counts, h3$counts),&#10;        beside = TRUE, col = c(&quot;red&quot;,&quot;blue&quot;,&quot;cyan&quot;),&#10;        names.arg = round(h1$breaks[-length(h1$breaks)]))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Normal Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Normal&quot;&gt;&lt;tr&gt;&lt;td&gt;Normal&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Normal Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the normal distribution with mean equal to &lt;code&gt;mean&lt;/code&gt;&#10;and standard deviation equal to &lt;code&gt;sd&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dnorm(x, mean = 0, sd = 1, log = FALSE)&#10;pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)&#10;qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)&#10;rnorm(n, mean = 0, sd = 1)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;mean&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of means.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;sd&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of standard deviations.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt; otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;code&gt;mean&lt;/code&gt; or &lt;code&gt;sd&lt;/code&gt; are not specified they assume the default&#10;values of &lt;code&gt;0&lt;/code&gt; and &lt;code&gt;1&lt;/code&gt;, respectively.&#10;&lt;/p&gt;&#10;&lt;p&gt;The normal distribution has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;&#10;    f(x) = 1/(&amp;radic;(2 &amp;pi;) &amp;sigma;) e^-((x - &amp;mu;)^2/(2 &amp;sigma;^2))&#10;  &lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;where &lt;i&gt;&amp;mu;&lt;/i&gt; is the mean of the distribution and&#10;&lt;i&gt;&amp;sigma;&lt;/i&gt; the standard deviation.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dnorm&lt;/code&gt; gives the density,&#10;&lt;code&gt;pnorm&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qnorm&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rnorm&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rnorm&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&lt;p&gt;For &lt;code&gt;sd = 0&lt;/code&gt; this gives the limit as &lt;code&gt;sd&lt;/code&gt; decreases to 0, a&#10;point mass at &lt;code&gt;mu&lt;/code&gt;.&#10;&lt;code&gt;sd &amp;lt; 0&lt;/code&gt; is an error and returns &lt;code&gt;NaN&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;For &lt;code&gt;pnorm&lt;/code&gt;, based on&#10;&lt;/p&gt;&#10;&lt;p&gt;Cody, W. D. (1993)&#10;Algorithm 715: SPECFUN &amp;ndash; A portable FORTRAN package of special&#10;function routines and test drivers.&#10;&lt;em&gt;ACM Transactions on Mathematical Software&lt;/em&gt; &lt;b&gt;19&lt;/b&gt;, 22&amp;ndash;32.&#10;&lt;/p&gt;&#10;&lt;p&gt;For &lt;code&gt;qnorm&lt;/code&gt;, the code is a C translation of&#10;&lt;/p&gt;&#10;&lt;p&gt;Wichura, M. J. (1988)&#10;Algorithm AS 241: The percentage points of the normal distribution.&#10;&lt;em&gt;Applied Statistics&lt;/em&gt;, &lt;b&gt;37&lt;/b&gt;, 477&amp;ndash;484.&#10;&lt;/p&gt;&#10;&lt;p&gt;which provides precise results up to about 16 digits.&#10;&lt;/p&gt;&#10;&lt;p&gt;For &lt;code&gt;rnorm&lt;/code&gt;, see RNG for how to select the algorithm and&#10;for references to the supplied methods.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 1, chapter 13.&#10;Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dlnorm&lt;/code&gt; for the &lt;em&gt;Log&lt;/em&gt;normal distribution.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;dnorm(0) == 1/sqrt(2*pi)&#10;dnorm(1) == exp(-1/2)/sqrt(2*pi)&#10;dnorm(1) == 1/sqrt(2*pi*exp(1))&#10;&#10;## Using &quot;log = TRUE&quot; for an extended range :&#10;par(mfrow = c(2,1))&#10;plot(function(x) dnorm(x, log = TRUE), -60, 50,&#10;     main = &quot;log { Normal density }&quot;)&#10;curve(log(dnorm(x)), add = TRUE, col = &quot;red&quot;, lwd = 2)&#10;mtext(&quot;dnorm(x, log=TRUE)&quot;, adj = 0)&#10;mtext(&quot;log(dnorm(x))&quot;, col = &quot;red&quot;, adj = 1)&#10;&#10;plot(function(x) pnorm(x, log.p = TRUE), -50, 10,&#10;     main = &quot;log { Normal Cumulative }&quot;)&#10;curve(log(pnorm(x)), add = TRUE, col = &quot;red&quot;, lwd = 2)&#10;mtext(&quot;pnorm(x, log=TRUE)&quot;, adj = 0)&#10;mtext(&quot;log(pnorm(x))&quot;, col = &quot;red&quot;, adj = 1)&#10;&#10;## if you want the so-called &#39;error function&#39;&#10;erf &amp;lt;- function(x) 2 * pnorm(x * sqrt(2)) - 1&#10;## (see Abramowitz and Stegun 29.2.29)&#10;## and the so-called &#39;complementary error function&#39;&#10;erfc &amp;lt;- function(x) 2 * pnorm(x * sqrt(2), lower = FALSE)&#10;## and the inverses&#10;erfinv &amp;lt;- function (x) qnorm((1 + x)/2)/sqrt(2)&#10;erfcinv &amp;lt;- function (x) qnorm(x/2, lower = FALSE)/sqrt(2)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Poisson Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Poisson&quot;&gt;&lt;tr&gt;&lt;td&gt;Poisson&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Poisson Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the Poisson distribution with parameter &lt;code&gt;lambda&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dpois(x, lambda, log = FALSE)&#10;ppois(q, lambda, lower.tail = TRUE, log.p = FALSE)&#10;qpois(p, lambda, lower.tail = TRUE, log.p = FALSE)&#10;rpois(n, lambda)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of (non-negative integer) quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of random values to return.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lambda&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of (non-negative) means.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The Poisson distribution has density&#10;&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;p(x) = &amp;lambda;^x exp(-&amp;lambda;)/x!&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;x = 0, 1, 2, &amp;hellip;&lt;/i&gt; .&#10;The mean and variance are &lt;i&gt;E(X) = Var(X) = &amp;lambda;&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that &lt;i&gt;&amp;lambda; = 0&lt;/i&gt; is really a limit case (setting&#10;&lt;i&gt;0^0 = 1&lt;/i&gt;) resulting in a point mass at &lt;i&gt;0&lt;/i&gt;, see also the example.&#10;&lt;/p&gt;&#10;&lt;p&gt;If an element of &lt;code&gt;x&lt;/code&gt; is not integer, the result of &lt;code&gt;dpois&lt;/code&gt;&#10;is zero, with a warning.&#10;&lt;i&gt;p(x)&lt;/i&gt; is computed using Loader&#39;s algorithm, see the reference in&#10;&lt;code&gt;dbinom&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The quantile is right continuous: &lt;code&gt;qpois(p, lambda)&lt;/code&gt; is the smallest&#10;integer &lt;i&gt;x&lt;/i&gt; such that &lt;i&gt;P(X &amp;le; x) &amp;ge; p&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Setting &lt;code&gt;lower.tail = FALSE&lt;/code&gt; allows to get much more precise&#10;results when the default, &lt;code&gt;lower.tail = TRUE&lt;/code&gt; would return 1, see&#10;the example below.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dpois&lt;/code&gt; gives the (log) density,&#10;&lt;code&gt;ppois&lt;/code&gt; gives the (log) distribution function,&#10;&lt;code&gt;qpois&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rpois&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid &lt;code&gt;lambda&lt;/code&gt; will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rpois&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rpois&lt;/code&gt; returns a vector of type integer unless generated&#10;values exceed the maximum representable integer when &lt;code&gt;double&lt;/code&gt;&#10;values are returned since R version 4.0.0.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dpois&lt;/code&gt; uses C code contributed by Catherine Loader&#10;(see &lt;code&gt;dbinom&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;ppois&lt;/code&gt; uses &lt;code&gt;pgamma&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;qpois&lt;/code&gt; uses the Cornish&amp;ndash;Fisher Expansion to include a skewness&#10;correction to a normal approximation, followed by a search.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rpois&lt;/code&gt; uses&#10;&lt;/p&gt;&#10;&lt;p&gt;Ahrens, J. H. and Dieter, U. (1982).&#10;Computer generation of Poisson deviates from modified normal distributions.&#10;&lt;em&gt;ACM Transactions on Mathematical Software&lt;/em&gt;, &lt;b&gt;8&lt;/b&gt;, 163&amp;ndash;179.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;dbinom&lt;/code&gt; for the binomial and &lt;code&gt;dnbinom&lt;/code&gt; for&#10;the negative binomial distribution.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;poisson.test&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;-log(dpois(0:7, lambda = 1) * gamma(1+ 0:7)) # == 1&#10;Ni &amp;lt;- rpois(50, lambda = 4); table(factor(Ni, 0:max(Ni)))&#10;&#10;1 - ppois(10*(15:25), lambda = 100)  # becomes 0 (cancellation)&#10;    ppois(10*(15:25), lambda = 100, lower.tail = FALSE)  # no cancellation&#10;&#10;par(mfrow = c(2, 1))&#10;x &amp;lt;- seq(-0.01, 5, 0.01)&#10;plot(x, ppois(x, 1), type = &quot;s&quot;, ylab = &quot;F(x)&quot;, main = &quot;Poisson(1) CDF&quot;)&#10;plot(x, pbinom(x, 100, 0.01), type = &quot;s&quot;, ylab = &quot;F(x)&quot;,&#10;     main = &quot;Binomial(100, 0.01) CDF&quot;)&#10;&#10;## The (limit) case  lambda = 0 :&#10;stopifnot(identical(dpois(0,0), 1),&#10;\t  identical(ppois(0,0), 1),&#10;\t  identical(qpois(1,0), 0))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Distribution of the Wilcoxon Signed Rank Statistic&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for SignRank&quot;&gt;&lt;tr&gt;&lt;td&gt;SignRank&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Distribution of the Wilcoxon Signed Rank Statistic&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the distribution of the Wilcoxon Signed Rank statistic&#10;obtained from a sample with size &lt;code&gt;n&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dsignrank(x, n, log = FALSE)&#10;psignrank(q, n, lower.tail = TRUE, log.p = FALSE)&#10;qsignrank(p, n, lower.tail = TRUE, log.p = FALSE)&#10;rsignrank(nn, n)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;nn&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(nn) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number(s) of observations in the sample(s).  A positive&#10;integer, or a vector of such integers.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;This distribution is obtained as follows.  Let &lt;code&gt;x&lt;/code&gt; be a sample of&#10;size &lt;code&gt;n&lt;/code&gt; from a continuous distribution symmetric about the&#10;origin.  Then the Wilcoxon signed rank statistic is the sum of the&#10;ranks of the absolute values &lt;code&gt;x[i]&lt;/code&gt; for which &lt;code&gt;x[i]&lt;/code&gt; is&#10;positive.  This statistic takes values between &lt;i&gt;0&lt;/i&gt; and&#10;&lt;i&gt;n(n+1)/2&lt;/i&gt;, and its mean and variance are &lt;i&gt;n(n+1)/4&lt;/i&gt; and&#10;&lt;i&gt;n(n+1)(2n+1)/24&lt;/i&gt;, respectively.&#10;&lt;/p&gt;&#10;&lt;p&gt;If either of the first two arguments is a vector, the recycling rule is&#10;used to do the calculations for all combinations of the two up to&#10;the length of the longer vector.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dsignrank&lt;/code&gt; gives the density,&#10;&lt;code&gt;psignrank&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qsignrank&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rsignrank&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;nn&lt;/code&gt; for&#10;&lt;code&gt;rsignrank&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;nn&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Author(s)&lt;/h3&gt;&#10;&#10;&lt;p&gt;Kurt Hornik; efficiency improvement by Ivo Ugrina.&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;wilcox.test&lt;/code&gt; to calculate the statistic from data, find p&#10;values and so on.&#10;&lt;/p&gt;&#10;&lt;p&gt;Distributions for standard distributions, including&#10;&lt;code&gt;dwilcox&lt;/code&gt; for the distribution of &lt;em&gt;two-sample&lt;/em&gt;&#10;Wilcoxon rank sum statistic.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;par(mfrow = c(2,2))&#10;for(n in c(4:5,10,40)) {&#10;  x &amp;lt;- seq(0, n*(n+1)/2, length = 501)&#10;  plot(x, dsignrank(x, n = n), type = &quot;l&quot;,&#10;       main = paste0(&quot;dsignrank(x, n = &quot;, n, &quot;)&quot;))&#10;}&#10;&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Regression Deletion Diagnostics&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for influence.measures&quot;&gt;&lt;tr&gt;&lt;td&gt;influence.measures&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Regression Deletion Diagnostics&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;This suite of functions can be used to compute some of the regression&#10;(leave-one-out deletion) diagnostics for linear and generalized linear&#10;models discussed in Belsley, Kuh and Welsch (1980), Cook and Weisberg (1982),&#10;etc.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;influence.measures(model, infl = influence(model))&#10;&#10;rstandard(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;rstandard(model, infl = lm.influence(model, do.coef = FALSE),&#10;          sd = sqrt(deviance(model)/df.residual(model)),&#10;          type = c(&quot;sd.1&quot;, &quot;predictive&quot;), ...)&#10;## S3 method for class &#39;glm&#39;&#10;rstandard(model, infl = influence(model, do.coef = FALSE),&#10;          type = c(&quot;deviance&quot;, &quot;pearson&quot;), ...)&#10;&#10;rstudent(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;rstudent(model, infl = lm.influence(model, do.coef = FALSE),&#10;         res = infl$wt.res, ...)&#10;## S3 method for class &#39;glm&#39;&#10;rstudent(model, infl = influence(model, do.coef = FALSE), ...)&#10;&#10;dffits(model, infl = , res = )&#10;&#10;dfbeta(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;dfbeta(model, infl = lm.influence(model, do.coef = TRUE), ...)&#10;&#10;dfbetas(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;dfbetas(model, infl = lm.influence(model, do.coef = TRUE), ...)&#10;&#10;covratio(model, infl = lm.influence(model, do.coef = FALSE),&#10;         res = weighted.residuals(model))&#10;&#10;cooks.distance(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;cooks.distance(model, infl = lm.influence(model, do.coef = FALSE),&#10;               res = weighted.residuals(model),&#10;               sd = sqrt(deviance(model)/df.residual(model)),&#10;               hat = infl$hat, ...)&#10;## S3 method for class &#39;glm&#39;&#10;cooks.distance(model, infl = influence(model, do.coef = FALSE),&#10;               res = infl$pear.res,&#10;               dispersion = summary(model)$dispersion,&#10;               hat = infl$hat, ...)&#10;&#10;hatvalues(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;hatvalues(model, infl = lm.influence(model, do.coef = FALSE), ...)&#10;&#10;hat(x, intercept = TRUE)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;model&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an &lt;span style=&quot;font-family: Courier New, Courier; color: #666666;&quot;&gt;&lt;b&gt;R&lt;/b&gt;&lt;/span&gt; object, typically returned by &lt;code&gt;lm&lt;/code&gt; or&#10;&lt;code&gt;glm&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;infl&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;influence structure as returned by&#10;&lt;code&gt;lm.influence&lt;/code&gt; or &lt;code&gt;influence&lt;/code&gt; (the latter&#10;only for the &lt;code&gt;glm&lt;/code&gt; method of &lt;code&gt;rstudent&lt;/code&gt; and&#10;&lt;code&gt;cooks.distance&lt;/code&gt;).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;res&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;(possibly weighted) residuals, with proper default.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;sd&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;standard deviation to use, see default.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;dispersion&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;dispersion (for &lt;code&gt;glm&lt;/code&gt; objects) to use,&#10;see default.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;hat&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;hat values &lt;i&gt;H[i,i]&lt;/i&gt;, see default.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;type&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;type of residuals for &lt;code&gt;rstandard&lt;/code&gt;, with different&#10;options and meanings for &lt;code&gt;lm&lt;/code&gt; and &lt;code&gt;glm&lt;/code&gt;.  Can be&#10;abbreviated.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the &lt;i&gt;X&lt;/i&gt; or design matrix.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;intercept&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;should an intercept column be prepended to &lt;code&gt;x&lt;/code&gt;?&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;further arguments passed to or from other methods.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The primary high-level function is &lt;code&gt;influence.measures&lt;/code&gt; which produces a&#10;class &lt;code&gt;&quot;infl&quot;&lt;/code&gt; object tabular display showing the DFBETAS for&#10;each model variable, DFFITS, covariance ratios, Cook&#39;s distances and&#10;the diagonal elements of the hat matrix.  Cases which are influential&#10;with respect to any of these measures are marked with an asterisk.&#10;&lt;/p&gt;&#10;&lt;p&gt;The functions &lt;code&gt;dfbetas&lt;/code&gt;, &lt;code&gt;dffits&lt;/code&gt;,&#10;&lt;code&gt;covratio&lt;/code&gt; and &lt;code&gt;cooks.distance&lt;/code&gt; provide direct access to the&#10;corresponding diagnostic quantities.  Functions &lt;code&gt;rstandard&lt;/code&gt; and&#10;&lt;code&gt;rstudent&lt;/code&gt; give the standardized and Studentized residuals&#10;respectively. (These re-normalize the residuals to have unit variance,&#10;using an overall and leave-one-out measure of the error variance&#10;respectively.)&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that for &lt;em&gt;multivariate&lt;/em&gt; &lt;code&gt;lm()&lt;/code&gt; models (of class&#10;&lt;code&gt;&quot;mlm&quot;&lt;/code&gt;), these functions return 3d arrays instead of matrices,&#10;or matrices instead of vectors.&#10;&lt;/p&gt;&#10;&lt;p&gt;Values for generalized linear models are approximations, as described&#10;in Williams (1987) (except that Cook&#39;s distances are scaled as&#10;&lt;i&gt;F&lt;/i&gt; rather than as chi-square values).  The approximations can be&#10;poor when some cases have large influence.&#10;&lt;/p&gt;&#10;&lt;p&gt;The optional &lt;code&gt;infl&lt;/code&gt;, &lt;code&gt;res&lt;/code&gt; and &lt;code&gt;sd&lt;/code&gt; arguments are there&#10;to encourage the use of these direct access functions, in situations&#10;where, e.g., the underlying basic influence measures (from&#10;&lt;code&gt;lm.influence&lt;/code&gt; or the generic &lt;code&gt;influence&lt;/code&gt;) are&#10;already available.&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that cases with &lt;code&gt;weights == 0&lt;/code&gt; are &lt;em&gt;dropped&lt;/em&gt; from all&#10;these functions, but that if a linear model has been fitted with&#10;&lt;code&gt;na.action = na.exclude&lt;/code&gt;, suitable values are filled in for the&#10;cases excluded during fitting.&#10;&lt;/p&gt;&#10;&lt;p&gt;For linear models, &lt;code&gt;rstandard(*, type = &quot;predictive&quot;)&lt;/code&gt; provides&#10;leave-one-out cross validation residuals, and the &amp;ldquo;PRESS&amp;rdquo;&#10;statistic (&lt;b&gt;PRE&lt;/b&gt;dictive &lt;b&gt;S&lt;/b&gt;um of &lt;b&gt;S&lt;/b&gt;quares, the same as&#10;the CV score) of model &lt;code&gt;model&lt;/code&gt; is &lt;/p&gt;&#10;&lt;pre&gt;   PRESS &amp;lt;- sum(rstandard(model, type=&quot;pred&quot;)^2)&lt;/pre&gt;&#10;&lt;p&gt;The function &lt;code&gt;hat()&lt;/code&gt; exists mainly for S (version 2)&#10;compatibility; we recommend using &lt;code&gt;hatvalues()&lt;/code&gt; instead.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;For &lt;code&gt;hatvalues&lt;/code&gt;, &lt;code&gt;dfbeta&lt;/code&gt;, and &lt;code&gt;dfbetas&lt;/code&gt;, the method&#10;for linear models also works for generalized linear models.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Author(s)&lt;/h3&gt;&#10;&#10;&lt;p&gt;Several R core team members and John Fox, originally in his &amp;lsquo;&lt;span class=&quot;file&quot;&gt;car&lt;/span&gt;&amp;rsquo;&#10;package.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Belsley, D. A., Kuh, E. and Welsch, R. E. (1980).&#10;&lt;em&gt;Regression Diagnostics&lt;/em&gt;.&#10;New York: Wiley.&#10;&lt;/p&gt;&#10;&lt;p&gt;Cook, R. D. and Weisberg, S. (1982).&#10;&lt;em&gt;Residuals and Influence in Regression&lt;/em&gt;.&#10;London: Chapman and Hall.&#10;&lt;/p&gt;&#10;&lt;p&gt;Williams, D. A. (1987).&#10;Generalized linear model diagnostics using the deviance and single&#10;case deletions.&#10;&lt;em&gt;Applied Statistics&lt;/em&gt;, &lt;b&gt;36&lt;/b&gt;, 181&amp;ndash;191.&#10;doi: &lt;a href=&quot;https://doi.org/10.2307/2347550&quot;&gt;10.2307/2347550&lt;/a&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Fox, J. (1997).&#10;&lt;em&gt;Applied Regression, Linear Models, and Related Methods&lt;/em&gt;.&#10;Sage.&#10;&lt;/p&gt;&#10;&lt;p&gt;Fox, J. (2002)&#10;&lt;em&gt;An R and S-Plus Companion to Applied Regression&lt;/em&gt;.&#10;Sage Publ.&#10;&lt;/p&gt;&#10;&lt;p&gt;Fox, J. and Weisberg, S. (2011).&#10;&lt;em&gt;An R Companion to Applied Regression&lt;/em&gt;, second edition.&#10;Sage Publ;&#10;&lt;a href=&quot;https://socialsciences.mcmaster.ca/jfox/Books/Companion/&quot;&gt;https://socialsciences.mcmaster.ca/jfox/Books/Companion/&lt;/a&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;influence&lt;/code&gt; (containing &lt;code&gt;lm.influence&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&amp;lsquo;plotmath&amp;rsquo; for the use of &lt;code&gt;hat&lt;/code&gt; in plot annotation.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;## Analysis of the life-cycle savings data&#10;## given in Belsley, Kuh and Welsch.&#10;lm.SR &amp;lt;- lm(sr ~ pop15 + pop75 + dpi + ddpi, data = LifeCycleSavings)&#10;&#10;inflm.SR &amp;lt;- influence.measures(lm.SR)&#10;which(apply(inflm.SR$is.inf, 1, any))&#10;# which observations &#39;are&#39; influential&#10;summary(inflm.SR) # only these&#10;inflm.SR          # all&#10;plot(rstudent(lm.SR) ~ hatvalues(lm.SR)) # recommended by some&#10;plot(lm.SR, which = 5) # an enhanced version of that via plot(&amp;lt;lm&amp;gt;)&#10;&#10;## The &#39;infl&#39; argument is not needed, but avoids recomputation:&#10;rs &amp;lt;- rstandard(lm.SR)&#10;iflSR &amp;lt;- influence(lm.SR)&#10;all.equal(rs, rstandard(lm.SR, infl = iflSR), tol = 1e-10)&#10;## to &quot;see&quot; the larger values:&#10;1000 * round(dfbetas(lm.SR, infl = iflSR), 3)&#10;cat(&quot;PRESS :&quot;); (PRESS &amp;lt;- sum( rstandard(lm.SR, type = &quot;predictive&quot;)^2 ))&#10;stopifnot(all.equal(PRESS, sum( (residuals(lm.SR) / (1 - iflSR$hat))^2)))&#10;&#10;## Show that &quot;PRE-residuals&quot;  ==  L.O.O. Crossvalidation (CV) errors:&#10;X &amp;lt;- model.matrix(lm.SR)&#10;y &amp;lt;- model.response(model.frame(lm.SR))&#10;## Leave-one-out CV least-squares prediction errors (relatively fast)&#10;rCV &amp;lt;- vapply(seq_len(nrow(X)), function(i)&#10;              y[i] - X[i,] %*% .lm.fit(X[-i,], y[-i])$coef,&#10;              numeric(1))&#10;## are the same as the *faster* rstandard(*, &quot;pred&quot;) :&#10;stopifnot(all.equal(rCV, unname(rstandard(lm.SR, type = &quot;predictive&quot;))))&#10;&#10;&#10;## Huber&#39;s data [Atkinson 1985]&#10;xh &amp;lt;- c(-4:0, 10)&#10;yh &amp;lt;- c(2.48, .73, -.04, -1.44, -1.32, 0)&#10;lmH &amp;lt;- lm(yh ~ xh)&#10;summary(lmH)&#10;im &amp;lt;- influence.measures(lmH)&#10; im &#10;plot(xh,yh, main = &quot;Huber&#39;s data: L.S. line and influential obs.&quot;)&#10;abline(lmH); points(xh[im$is.inf], yh[im$is.inf], pch = 20, col = 2)&#10;&#10;## Irwin&#39;s data [Williams 1987]&#10;xi &amp;lt;- 1:5&#10;yi &amp;lt;- c(0,2,14,19,30)    # number of mice responding to dose xi&#10;mi &amp;lt;- rep(40, 5)         # number of mice exposed&#10;glmI &amp;lt;- glm(cbind(yi, mi -yi) ~ xi, family = binomial)&#10;summary(glmI)&#10;signif(cooks.distance(glmI), 3)   # ~= Ci in Table 3, p.184&#10;imI &amp;lt;- influence.measures(glmI)&#10; imI &#10;stopifnot(all.equal(imI$infmat[,&quot;cook.d&quot;],&#10;          cooks.distance(glmI)))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Regression Deletion Diagnostics&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for influence.measures&quot;&gt;&lt;tr&gt;&lt;td&gt;influence.measures&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Regression Deletion Diagnostics&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;This suite of functions can be used to compute some of the regression&#10;(leave-one-out deletion) diagnostics for linear and generalized linear&#10;models discussed in Belsley, Kuh and Welsch (1980), Cook and Weisberg (1982),&#10;etc.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;influence.measures(model, infl = influence(model))&#10;&#10;rstandard(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;rstandard(model, infl = lm.influence(model, do.coef = FALSE),&#10;          sd = sqrt(deviance(model)/df.residual(model)),&#10;          type = c(&quot;sd.1&quot;, &quot;predictive&quot;), ...)&#10;## S3 method for class &#39;glm&#39;&#10;rstandard(model, infl = influence(model, do.coef = FALSE),&#10;          type = c(&quot;deviance&quot;, &quot;pearson&quot;), ...)&#10;&#10;rstudent(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;rstudent(model, infl = lm.influence(model, do.coef = FALSE),&#10;         res = infl$wt.res, ...)&#10;## S3 method for class &#39;glm&#39;&#10;rstudent(model, infl = influence(model, do.coef = FALSE), ...)&#10;&#10;dffits(model, infl = , res = )&#10;&#10;dfbeta(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;dfbeta(model, infl = lm.influence(model, do.coef = TRUE), ...)&#10;&#10;dfbetas(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;dfbetas(model, infl = lm.influence(model, do.coef = TRUE), ...)&#10;&#10;covratio(model, infl = lm.influence(model, do.coef = FALSE),&#10;         res = weighted.residuals(model))&#10;&#10;cooks.distance(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;cooks.distance(model, infl = lm.influence(model, do.coef = FALSE),&#10;               res = weighted.residuals(model),&#10;               sd = sqrt(deviance(model)/df.residual(model)),&#10;               hat = infl$hat, ...)&#10;## S3 method for class &#39;glm&#39;&#10;cooks.distance(model, infl = influence(model, do.coef = FALSE),&#10;               res = infl$pear.res,&#10;               dispersion = summary(model)$dispersion,&#10;               hat = infl$hat, ...)&#10;&#10;hatvalues(model, ...)&#10;## S3 method for class &#39;lm&#39;&#10;hatvalues(model, infl = lm.influence(model, do.coef = FALSE), ...)&#10;&#10;hat(x, intercept = TRUE)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;model&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;an &lt;span style=&quot;font-family: Courier New, Courier; color: #666666;&quot;&gt;&lt;b&gt;R&lt;/b&gt;&lt;/span&gt; object, typically returned by &lt;code&gt;lm&lt;/code&gt; or&#10;&lt;code&gt;glm&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;infl&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;influence structure as returned by&#10;&lt;code&gt;lm.influence&lt;/code&gt; or &lt;code&gt;influence&lt;/code&gt; (the latter&#10;only for the &lt;code&gt;glm&lt;/code&gt; method of &lt;code&gt;rstudent&lt;/code&gt; and&#10;&lt;code&gt;cooks.distance&lt;/code&gt;).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;res&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;(possibly weighted) residuals, with proper default.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;sd&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;standard deviation to use, see default.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;dispersion&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;dispersion (for &lt;code&gt;glm&lt;/code&gt; objects) to use,&#10;see default.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;hat&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;hat values &lt;i&gt;H[i,i]&lt;/i&gt;, see default.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;type&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;type of residuals for &lt;code&gt;rstandard&lt;/code&gt;, with different&#10;options and meanings for &lt;code&gt;lm&lt;/code&gt; and &lt;code&gt;glm&lt;/code&gt;.  Can be&#10;abbreviated.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;the &lt;i&gt;X&lt;/i&gt; or design matrix.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;intercept&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;should an intercept column be prepended to &lt;code&gt;x&lt;/code&gt;?&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;...&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;further arguments passed to or from other methods.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The primary high-level function is &lt;code&gt;influence.measures&lt;/code&gt; which produces a&#10;class &lt;code&gt;&quot;infl&quot;&lt;/code&gt; object tabular display showing the DFBETAS for&#10;each model variable, DFFITS, covariance ratios, Cook&#39;s distances and&#10;the diagonal elements of the hat matrix.  Cases which are influential&#10;with respect to any of these measures are marked with an asterisk.&#10;&lt;/p&gt;&#10;&lt;p&gt;The functions &lt;code&gt;dfbetas&lt;/code&gt;, &lt;code&gt;dffits&lt;/code&gt;,&#10;&lt;code&gt;covratio&lt;/code&gt; and &lt;code&gt;cooks.distance&lt;/code&gt; provide direct access to the&#10;corresponding diagnostic quantities.  Functions &lt;code&gt;rstandard&lt;/code&gt; and&#10;&lt;code&gt;rstudent&lt;/code&gt; give the standardized and Studentized residuals&#10;respectively. (These re-normalize the residuals to have unit variance,&#10;using an overall and leave-one-out measure of the error variance&#10;respectively.)&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that for &lt;em&gt;multivariate&lt;/em&gt; &lt;code&gt;lm()&lt;/code&gt; models (of class&#10;&lt;code&gt;&quot;mlm&quot;&lt;/code&gt;), these functions return 3d arrays instead of matrices,&#10;or matrices instead of vectors.&#10;&lt;/p&gt;&#10;&lt;p&gt;Values for generalized linear models are approximations, as described&#10;in Williams (1987) (except that Cook&#39;s distances are scaled as&#10;&lt;i&gt;F&lt;/i&gt; rather than as chi-square values).  The approximations can be&#10;poor when some cases have large influence.&#10;&lt;/p&gt;&#10;&lt;p&gt;The optional &lt;code&gt;infl&lt;/code&gt;, &lt;code&gt;res&lt;/code&gt; and &lt;code&gt;sd&lt;/code&gt; arguments are there&#10;to encourage the use of these direct access functions, in situations&#10;where, e.g., the underlying basic influence measures (from&#10;&lt;code&gt;lm.influence&lt;/code&gt; or the generic &lt;code&gt;influence&lt;/code&gt;) are&#10;already available.&#10;&lt;/p&gt;&#10;&lt;p&gt;Note that cases with &lt;code&gt;weights == 0&lt;/code&gt; are &lt;em&gt;dropped&lt;/em&gt; from all&#10;these functions, but that if a linear model has been fitted with&#10;&lt;code&gt;na.action = na.exclude&lt;/code&gt;, suitable values are filled in for the&#10;cases excluded during fitting.&#10;&lt;/p&gt;&#10;&lt;p&gt;For linear models, &lt;code&gt;rstandard(*, type = &quot;predictive&quot;)&lt;/code&gt; provides&#10;leave-one-out cross validation residuals, and the &amp;ldquo;PRESS&amp;rdquo;&#10;statistic (&lt;b&gt;PRE&lt;/b&gt;dictive &lt;b&gt;S&lt;/b&gt;um of &lt;b&gt;S&lt;/b&gt;quares, the same as&#10;the CV score) of model &lt;code&gt;model&lt;/code&gt; is &lt;/p&gt;&#10;&lt;pre&gt;   PRESS &amp;lt;- sum(rstandard(model, type=&quot;pred&quot;)^2)&lt;/pre&gt;&#10;&lt;p&gt;The function &lt;code&gt;hat()&lt;/code&gt; exists mainly for S (version 2)&#10;compatibility; we recommend using &lt;code&gt;hatvalues()&lt;/code&gt; instead.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;For &lt;code&gt;hatvalues&lt;/code&gt;, &lt;code&gt;dfbeta&lt;/code&gt;, and &lt;code&gt;dfbetas&lt;/code&gt;, the method&#10;for linear models also works for generalized linear models.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Author(s)&lt;/h3&gt;&#10;&#10;&lt;p&gt;Several R core team members and John Fox, originally in his &amp;lsquo;&lt;span class=&quot;file&quot;&gt;car&lt;/span&gt;&amp;rsquo;&#10;package.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Belsley, D. A., Kuh, E. and Welsch, R. E. (1980).&#10;&lt;em&gt;Regression Diagnostics&lt;/em&gt;.&#10;New York: Wiley.&#10;&lt;/p&gt;&#10;&lt;p&gt;Cook, R. D. and Weisberg, S. (1982).&#10;&lt;em&gt;Residuals and Influence in Regression&lt;/em&gt;.&#10;London: Chapman and Hall.&#10;&lt;/p&gt;&#10;&lt;p&gt;Williams, D. A. (1987).&#10;Generalized linear model diagnostics using the deviance and single&#10;case deletions.&#10;&lt;em&gt;Applied Statistics&lt;/em&gt;, &lt;b&gt;36&lt;/b&gt;, 181&amp;ndash;191.&#10;doi: &lt;a href=&quot;https://doi.org/10.2307/2347550&quot;&gt;10.2307/2347550&lt;/a&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Fox, J. (1997).&#10;&lt;em&gt;Applied Regression, Linear Models, and Related Methods&lt;/em&gt;.&#10;Sage.&#10;&lt;/p&gt;&#10;&lt;p&gt;Fox, J. (2002)&#10;&lt;em&gt;An R and S-Plus Companion to Applied Regression&lt;/em&gt;.&#10;Sage Publ.&#10;&lt;/p&gt;&#10;&lt;p&gt;Fox, J. and Weisberg, S. (2011).&#10;&lt;em&gt;An R Companion to Applied Regression&lt;/em&gt;, second edition.&#10;Sage Publ;&#10;&lt;a href=&quot;https://socialsciences.mcmaster.ca/jfox/Books/Companion/&quot;&gt;https://socialsciences.mcmaster.ca/jfox/Books/Companion/&lt;/a&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;influence&lt;/code&gt; (containing &lt;code&gt;lm.influence&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;&amp;lsquo;plotmath&amp;rsquo; for the use of &lt;code&gt;hat&lt;/code&gt; in plot annotation.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;## Analysis of the life-cycle savings data&#10;## given in Belsley, Kuh and Welsch.&#10;lm.SR &amp;lt;- lm(sr ~ pop15 + pop75 + dpi + ddpi, data = LifeCycleSavings)&#10;&#10;inflm.SR &amp;lt;- influence.measures(lm.SR)&#10;which(apply(inflm.SR$is.inf, 1, any))&#10;# which observations &#39;are&#39; influential&#10;summary(inflm.SR) # only these&#10;inflm.SR          # all&#10;plot(rstudent(lm.SR) ~ hatvalues(lm.SR)) # recommended by some&#10;plot(lm.SR, which = 5) # an enhanced version of that via plot(&amp;lt;lm&amp;gt;)&#10;&#10;## The &#39;infl&#39; argument is not needed, but avoids recomputation:&#10;rs &amp;lt;- rstandard(lm.SR)&#10;iflSR &amp;lt;- influence(lm.SR)&#10;all.equal(rs, rstandard(lm.SR, infl = iflSR), tol = 1e-10)&#10;## to &quot;see&quot; the larger values:&#10;1000 * round(dfbetas(lm.SR, infl = iflSR), 3)&#10;cat(&quot;PRESS :&quot;); (PRESS &amp;lt;- sum( rstandard(lm.SR, type = &quot;predictive&quot;)^2 ))&#10;stopifnot(all.equal(PRESS, sum( (residuals(lm.SR) / (1 - iflSR$hat))^2)))&#10;&#10;## Show that &quot;PRE-residuals&quot;  ==  L.O.O. Crossvalidation (CV) errors:&#10;X &amp;lt;- model.matrix(lm.SR)&#10;y &amp;lt;- model.response(model.frame(lm.SR))&#10;## Leave-one-out CV least-squares prediction errors (relatively fast)&#10;rCV &amp;lt;- vapply(seq_len(nrow(X)), function(i)&#10;              y[i] - X[i,] %*% .lm.fit(X[-i,], y[-i])$coef,&#10;              numeric(1))&#10;## are the same as the *faster* rstandard(*, &quot;pred&quot;) :&#10;stopifnot(all.equal(rCV, unname(rstandard(lm.SR, type = &quot;predictive&quot;))))&#10;&#10;&#10;## Huber&#39;s data [Atkinson 1985]&#10;xh &amp;lt;- c(-4:0, 10)&#10;yh &amp;lt;- c(2.48, .73, -.04, -1.44, -1.32, 0)&#10;lmH &amp;lt;- lm(yh ~ xh)&#10;summary(lmH)&#10;im &amp;lt;- influence.measures(lmH)&#10; im &#10;plot(xh,yh, main = &quot;Huber&#39;s data: L.S. line and influential obs.&quot;)&#10;abline(lmH); points(xh[im$is.inf], yh[im$is.inf], pch = 20, col = 2)&#10;&#10;## Irwin&#39;s data [Williams 1987]&#10;xi &amp;lt;- 1:5&#10;yi &amp;lt;- c(0,2,14,19,30)    # number of mice responding to dose xi&#10;mi &amp;lt;- rep(40, 5)         # number of mice exposed&#10;glmI &amp;lt;- glm(cbind(yi, mi -yi) ~ xi, family = binomial)&#10;summary(glmI)&#10;signif(cooks.distance(glmI), 3)   # ~= Ci in Table 3, p.184&#10;imI &amp;lt;- influence.measures(glmI)&#10; imI &#10;stopifnot(all.equal(imI$infmat[,&quot;cook.d&quot;],&#10;          cooks.distance(glmI)))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Student t Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for TDist&quot;&gt;&lt;tr&gt;&lt;td&gt;TDist&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Student t Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the t distribution with &lt;code&gt;df&lt;/code&gt; degrees of freedom&#10;(and optional non-centrality parameter &lt;code&gt;ncp&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dt(x, df, ncp, log = FALSE)&#10;pt(q, df, ncp, lower.tail = TRUE, log.p = FALSE)&#10;qt(p, df, ncp, lower.tail = TRUE, log.p = FALSE)&#10;rt(n, df, ncp)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;df&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;degrees of freedom (&lt;i&gt;&amp;gt; 0&lt;/i&gt;, maybe non-integer).  &lt;code&gt;df&#10;      = Inf&lt;/code&gt; is allowed.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;ncp&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;non-centrality parameter &lt;i&gt;delta&lt;/i&gt;;&#10;currently except for &lt;code&gt;rt()&lt;/code&gt;, only for &lt;code&gt;abs(ncp) &amp;lt;= 37.62&lt;/code&gt;.&#10;If omitted, use the central t distribution.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The &lt;i&gt;t&lt;/i&gt; distribution with &lt;code&gt;df&lt;/code&gt; &lt;i&gt;= n&lt;/i&gt; degrees of&#10;freedom has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = &amp;Gamma;((n+1)/2) / (&amp;radic;(n &amp;pi;) &amp;Gamma;(n/2)) (1 + x^2/n)^-((n+1)/2)&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for all real &lt;i&gt;x&lt;/i&gt;.&#10;It has mean &lt;i&gt;0&lt;/i&gt; (for &lt;i&gt;n &amp;gt; 1&lt;/i&gt;) and&#10;variance &lt;i&gt;n/(n-2)&lt;/i&gt; (for &lt;i&gt;n &amp;gt; 2&lt;/i&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;The general &lt;em&gt;non-central&lt;/em&gt; &lt;i&gt;t&lt;/i&gt;&#10;with parameters &lt;i&gt;(df, Del)&lt;/i&gt; &lt;code&gt;= (df, ncp)&lt;/code&gt;&#10;is defined as the distribution of&#10;&lt;i&gt;T(df, Del) := (U + Del) / &amp;radic;(V/df) &lt;/i&gt;&#10;where &lt;i&gt;U&lt;/i&gt; and &lt;i&gt;V&lt;/i&gt;  are independent random&#10;variables, &lt;i&gt;U ~ N(0,1)&lt;/i&gt; and&#10;&lt;i&gt;V ~ &amp;chi;^2(df)&lt;/i&gt; (see Chisquare).&#10;&lt;/p&gt;&#10;&lt;p&gt;The most used applications are power calculations for &lt;i&gt;t&lt;/i&gt;-tests:&lt;br /&gt;&#10;Let &lt;i&gt;T= (mX - m0) / (S/sqrt(n))&lt;/i&gt;&#10;where&#10;&lt;i&gt;mX&lt;/i&gt; is the &lt;code&gt;mean&lt;/code&gt; and &lt;i&gt;S&lt;/i&gt; the sample standard&#10;deviation (&lt;code&gt;sd&lt;/code&gt;) of &lt;i&gt;X_1, X_2, &amp;hellip;, X_n&lt;/i&gt; which are&#10;i.i.d. &lt;i&gt;N(&amp;mu;, &amp;sigma;^2)&lt;/i&gt;&#10;Then &lt;i&gt;T&lt;/i&gt; is distributed as non-central &lt;i&gt;t&lt;/i&gt; with&#10;&lt;code&gt;df&lt;/code&gt;&lt;i&gt;= n - 1&lt;/i&gt;&#10;degrees of freedom and &lt;b&gt;n&lt;/b&gt;on-&lt;b&gt;c&lt;/b&gt;entrality &lt;b&gt;p&lt;/b&gt;arameter&#10;&lt;code&gt;ncp&lt;/code&gt;&lt;i&gt; = (&amp;mu; - m0) * sqrt(n)/&amp;sigma;&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dt&lt;/code&gt; gives the density,&#10;&lt;code&gt;pt&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qt&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rt&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid arguments will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rt&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;Supplying &lt;code&gt;ncp = 0&lt;/code&gt; uses the algorithm for the non-central&#10;distribution, which is not the same algorithm used if &lt;code&gt;ncp&lt;/code&gt; is&#10;omitted.  This is to give consistent behaviour in extreme cases with&#10;values of &lt;code&gt;ncp&lt;/code&gt; very near zero.&#10;&lt;/p&gt;&#10;&lt;p&gt;The code for non-zero &lt;code&gt;ncp&lt;/code&gt; is principally intended to be used&#10;for moderate values of &lt;code&gt;ncp&lt;/code&gt;: it will not be highly accurate,&#10;especially in the tails, for large values.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;The central &lt;code&gt;dt&lt;/code&gt; is computed via an accurate formula&#10;provided by Catherine Loader (see the reference in &lt;code&gt;dbinom&lt;/code&gt;).&#10;&lt;/p&gt;&#10;&lt;p&gt;For the non-central case of &lt;code&gt;dt&lt;/code&gt;, C code contributed by&#10;Claus EkstrÃ¸m based on the relationship (for&#10;&lt;i&gt;x != 0&lt;/i&gt;) to the cumulative distribution.&#10;&lt;/p&gt;&#10;&lt;p&gt;For the central case of &lt;code&gt;pt&lt;/code&gt;, a normal approximation in the&#10;tails, otherwise via &lt;code&gt;pbeta&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;For the non-central case of &lt;code&gt;pt&lt;/code&gt; based on a C translation of&#10;&lt;/p&gt;&#10;&lt;p&gt;Lenth, R. V. (1989). &lt;em&gt;Algorithm AS 243&lt;/em&gt; &amp;mdash;&#10;Cumulative distribution function of the non-central &lt;i&gt;t&lt;/i&gt; distribution,&#10;&lt;em&gt;Applied Statistics&lt;/em&gt; &lt;b&gt;38&lt;/b&gt;, 185&amp;ndash;189.&#10;&lt;/p&gt;&#10;&lt;p&gt;This computes the lower tail only, so the upper tail suffers from&#10;cancellation and a warning will be given when this is likely to be&#10;significant.&#10;&lt;/p&gt;&#10;&lt;p&gt;For central &lt;code&gt;qt&lt;/code&gt;, a C translation of&#10;&lt;/p&gt;&#10;&lt;p&gt;Hill, G. W. (1970) Algorithm 396: Student&#39;s t-quantiles.&#10;&lt;em&gt;Communications of the ACM&lt;/em&gt;, &lt;b&gt;13(10)&lt;/b&gt;, 619&amp;ndash;620.&#10;&lt;/p&gt;&#10;&lt;p&gt;altered to take account of&#10;&lt;/p&gt;&#10;&lt;p&gt;Hill, G. W. (1981) Remark on Algorithm 396, &lt;em&gt;ACM Transactions on&#10;Mathematical Software&lt;/em&gt;, &lt;b&gt;7&lt;/b&gt;, 250&amp;ndash;1.&#10;&lt;/p&gt;&#10;&lt;p&gt;The non-central case is done by inversion.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole. (Except non-central versions.)&#10;&lt;/p&gt;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 2, chapters 28 and 31.&#10;Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;&lt;code&gt;df&lt;/code&gt; for the F distribution.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;1 - pt(1:5, df = 1)&#10;qt(.975, df = c(1:10,20,50,100,1000))&#10;&#10;tt &amp;lt;- seq(0, 10, len = 21)&#10;ncp &amp;lt;- seq(0, 6, len = 31)&#10;ptn &amp;lt;- outer(tt, ncp, function(t, d) pt(t, df = 3, ncp = d))&#10;t.tit &amp;lt;- &quot;Non-central t - Probabilities&quot;&#10;image(tt, ncp, ptn, zlim = c(0,1), main = t.tit)&#10;persp(tt, ncp, ptn, zlim = 0:1, r = 2, phi = 20, theta = 200, main = t.tit,&#10;      xlab = &quot;t&quot;, ylab = &quot;non-centrality parameter&quot;,&#10;      zlab = &quot;Pr(T &amp;lt;= t)&quot;)&#10;&#10;plot(function(x) dt(x, df = 3, ncp = 2), -3, 11, ylim = c(0, 0.32),&#10;     main = &quot;Non-central t - Density&quot;, yaxs = &quot;i&quot;)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Uniform Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Uniform&quot;&gt;&lt;tr&gt;&lt;td&gt;Uniform&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Uniform Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;These functions provide information about the uniform distribution&#10;on the interval from &lt;code&gt;min&lt;/code&gt; to &lt;code&gt;max&lt;/code&gt;.  &lt;code&gt;dunif&lt;/code&gt; gives the&#10;density, &lt;code&gt;punif&lt;/code&gt; gives the distribution function &lt;code&gt;qunif&lt;/code&gt;&#10;gives the quantile function and &lt;code&gt;runif&lt;/code&gt; generates random&#10;deviates.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dunif(x, min = 0, max = 1, log = FALSE)&#10;punif(q, min = 0, max = 1, lower.tail = TRUE, log.p = FALSE)&#10;qunif(p, min = 0, max = 1, lower.tail = TRUE, log.p = FALSE)&#10;runif(n, min = 0, max = 1)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;min, max&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;lower and upper limits of the distribution.  Must be finite.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;code&gt;min&lt;/code&gt; or &lt;code&gt;max&lt;/code&gt; are not specified they assume the default&#10;values of &lt;code&gt;0&lt;/code&gt; and &lt;code&gt;1&lt;/code&gt; respectively.&#10;&lt;/p&gt;&#10;&lt;p&gt;The uniform distribution has density&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = 1/(max-min)&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;for &lt;i&gt;min &amp;le; x &amp;le; max&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;For the case of &lt;i&gt;u := min == max&lt;/i&gt;, the limit case of&#10;&lt;i&gt;X == u&lt;/i&gt; is assumed, although there is no density in&#10;that case and &lt;code&gt;dunif&lt;/code&gt; will return &lt;code&gt;NaN&lt;/code&gt; (the error condition).&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;runif&lt;/code&gt; will not generate either of the extreme values unless&#10;&lt;code&gt;max = min&lt;/code&gt; or &lt;code&gt;max-min&lt;/code&gt; is small compared to &lt;code&gt;min&lt;/code&gt;,&#10;and in particular not for the default arguments.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dunif&lt;/code&gt; gives the density,&#10;&lt;code&gt;punif&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qunif&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;runif&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;runif&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;The characteristics of output from pseudo-random number generators&#10;(such as precision and periodicity) vary widely.  See&#10;&lt;code&gt;.Random.seed&lt;/code&gt; for more information on &lt;span style=&quot;font-family: Courier New, Courier; color: #666666;&quot;&gt;&lt;b&gt;R&lt;/b&gt;&lt;/span&gt;&#39;s random number&#10;generation algorithms.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)&#10;&lt;em&gt;The New S Language&lt;/em&gt;.&#10;Wadsworth &amp;amp; Brooks/Cole.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;RNG&lt;/code&gt; about random number generation in &lt;span style=&quot;font-family: Courier New, Courier; color: #666666;&quot;&gt;&lt;b&gt;R&lt;/b&gt;&lt;/span&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Distributions for other standard distributions.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;u &amp;lt;- runif(20)&#10;&#10;## The following relations always hold :&#10;punif(u) == u&#10;dunif(u) == 1&#10;&#10;var(runif(10000))  #- ~ = 1/12 = .08333&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Running Medians - Robust Scatter Plot Smoothing&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for runmed&quot;&gt;&lt;tr&gt;&lt;td&gt;runmed&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Running Medians &amp;ndash; Robust Scatter Plot Smoothing&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Compute running medians of odd span.  This is the &amp;lsquo;most robust&amp;rsquo;&#10;scatter plot smoothing possible.  For efficiency (and historical&#10;reason), you can use one of two different algorithms giving identical&#10;results.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;runmed(x, k, endrule = c(&quot;median&quot;, &quot;keep&quot;, &quot;constant&quot;),&#10;       algorithm = NULL,&#10;       na.action = c(&quot;+Big_alternate&quot;, &quot;-Big_alternate&quot;, &quot;na.omit&quot;, &quot;fail&quot;),&#10;       print.level = 0)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;numeric vector, the &amp;lsquo;dependent&amp;rsquo; variable to be&#10;smoothed.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;k&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;integer width of median window; must be odd.  Turlach had a&#10;default of &lt;code&gt;k &amp;lt;- 1 + 2 * min((n-1)%/% 2, ceiling(0.1*n))&lt;/code&gt;.&#10;Use &lt;code&gt;k = 3&lt;/code&gt; for &amp;lsquo;minimal&amp;rsquo; robust smoothing eliminating&#10;isolated outliers.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;endrule&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;character string indicating how the values at the&#10;beginning and the end (of the data) should be treated.&#10;Can be abbreviated.  Possible values are:&#10;&lt;/p&gt;&#10;&#10;&lt;dl&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;keep&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;keeps the first and last &lt;i&gt;k2&lt;/i&gt; values&#10;at both ends, where &lt;i&gt;k2&lt;/i&gt; is the half-bandwidth&#10;&lt;code&gt;k2 = k %/% 2&lt;/code&gt;,&#10;i.e., &lt;code&gt;y[j] = x[j]&lt;/code&gt; for &lt;i&gt;j = 1, &amp;hellip;, k2 and (n-k2+1), &amp;hellip;, n&lt;/i&gt;;&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;constant&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;copies &lt;code&gt;median(y[1:k2])&lt;/code&gt; to the first&#10;values and analogously for the last ones making the smoothed ends&#10;&lt;em&gt;constant&lt;/em&gt;;&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;median&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;the default, smooths the ends by using&#10;symmetrical medians of subsequently smaller bandwidth, but for&#10;the very first and last value where Tukey&#39;s robust end-point&#10;rule is applied, see &lt;code&gt;smoothEnds&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;/dl&gt;&#10;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;algorithm&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;character string (partially matching &lt;code&gt;&quot;Turlach&quot;&lt;/code&gt; or&#10;&lt;code&gt;&quot;Stuetzle&quot;&lt;/code&gt;) or the default &lt;code&gt;NULL&lt;/code&gt;, specifying which algorithm&#10;should be applied.  The default choice depends on &lt;code&gt;n = length(x)&lt;/code&gt;&#10;and &lt;code&gt;k&lt;/code&gt; where &lt;code&gt;&quot;Turlach&quot;&lt;/code&gt; will be used for larger problems.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;na.action&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;character string determining the behavior in the case of&#10;&lt;code&gt;NA&lt;/code&gt; or &lt;code&gt;NaN&lt;/code&gt; in &lt;code&gt;x&lt;/code&gt;, (partially matching)&#10;one of&#10;&lt;/p&gt;&#10;&#10;&lt;dl&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;+Big_alternate&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;Here, all the NAs in &lt;code&gt;x&lt;/code&gt; are&#10;first replaced by alternating &lt;i&gt;+/- B&lt;/i&gt; where &lt;i&gt;B&lt;/i&gt; is a&#10;&amp;ldquo;Big&amp;rdquo; number (with &lt;i&gt;2B &amp;lt; M*&lt;/i&gt;, where&#10;&lt;i&gt;M*=&lt;/i&gt;&lt;code&gt;.Machine $ double.xmax&lt;/code&gt;).  The replacement&#10;values are &amp;ldquo;from left&amp;rdquo; &lt;i&gt;(+B, -B, +B, &amp;hellip;)&lt;/i&gt;,&#10;i.e. start with &lt;code&gt;&quot;+&quot;&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;-Big_alternate&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;almost the same as&#10;&lt;code&gt;&quot;+Big_alternate&quot;&lt;/code&gt;, just starting with &lt;i&gt;-B&lt;/i&gt; (&lt;code&gt;&quot;-Big...&quot;&lt;/code&gt;).&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;na.omit&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;the result is the same as&#10;&lt;code&gt;runmed(x[!is.na(x)], k, ..)&lt;/code&gt;.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;fail&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;the presence of NAs in &lt;code&gt;x&lt;/code&gt; will raise an error.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;/dl&gt;&#10;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;print.level&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;integer, indicating verboseness of algorithm;&#10;should rarely be changed by average users.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;Apart from the end values, the result &lt;code&gt;y = runmed(x, k)&lt;/code&gt; simply has&#10;&lt;code&gt;y[j] = median(x[(j-k2):(j+k2)])&lt;/code&gt; (&lt;code&gt;k = 2*k2+1&lt;/code&gt;), computed very&#10;efficiently.&#10;&lt;/p&gt;&#10;&lt;p&gt;The two algorithms are internally entirely different:&#10;&lt;/p&gt;&#10;&#10;&lt;dl&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;Turlach&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;is the HÃ¤rdle&amp;ndash;Steiger&#10;algorithm (see Ref.) as implemented by Berwin Turlach.&#10;A tree algorithm is used, ensuring performance &lt;i&gt;O(n * log(k))&lt;/i&gt; where &lt;code&gt;n = length(x)&lt;/code&gt; which is&#10;asymptotically optimal.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;Stuetzle&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;is the (older) Stuetzle&amp;ndash;Friedman implementation&#10;which makes use of median &lt;em&gt;updating&lt;/em&gt; when one observation&#10;enters and one leaves the smoothing window.  While this performs as&#10;&lt;i&gt;O(n * k)&lt;/i&gt; which is slower asymptotically, it is&#10;considerably faster for small &lt;i&gt;k&lt;/i&gt; or &lt;i&gt;n&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;/dl&gt;&#10;&#10;&lt;p&gt;Note that, both algorithms (and the &lt;code&gt;smoothEnds()&lt;/code&gt; utility)&#10;now &amp;ldquo;work&amp;rdquo; also when &lt;code&gt;x&lt;/code&gt; contains non-finite entries&#10;(&lt;i&gt;+/-&lt;/i&gt;&lt;code&gt;Inf&lt;/code&gt;, &lt;code&gt;NaN&lt;/code&gt;, and&#10;&lt;code&gt;NA&lt;/code&gt;):&#10;&lt;/p&gt;&#10;&#10;&lt;dl&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;Turlach&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;.......&#10;&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;dt&gt;&lt;code&gt;&quot;Stuetzle&quot;&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;&lt;p&gt;currently simply works by applying the&#10;underlying math library (&amp;lsquo;&lt;span class=&quot;file&quot;&gt;libm&lt;/span&gt;&amp;rsquo;) arithmetic for the non-finite&#10;numbers; this may optionally change in the future.&#10;&lt;/p&gt;&#10;&lt;/dd&gt;&#10;&lt;/dl&gt;&#10;&#10;&lt;p&gt;Currently long vectors are only supported for &lt;code&gt;algorithm = &quot;Stuetzle&quot;&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;vector of smoothed values of the same length as &lt;code&gt;x&lt;/code&gt; with an&#10;&lt;code&gt;attr&lt;/code&gt;ibute &lt;code&gt;k&lt;/code&gt; containing (the &amp;lsquo;oddified&amp;rsquo;)&#10;&lt;code&gt;k&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Author(s)&lt;/h3&gt;&#10;&#10;&lt;p&gt;Martin Maechler &lt;a href=&quot;mailto:maechler@stat.math.ethz.ch&quot;&gt;maechler@stat.math.ethz.ch&lt;/a&gt;,&#10;based on Fortran code from Werner Stuetzle and S-PLUS and C code from&#10;Berwin Turlach.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;HÃ¤rdle, W. and Steiger, W. (1995)&#10;Algorithm AS 296: Optimal median smoothing,&#10;&lt;em&gt;Applied Statistics&lt;/em&gt; &lt;b&gt;44&lt;/b&gt;, 258&amp;ndash;264.&#10;doi: &lt;a href=&quot;https://doi.org/10.2307/2986349&quot;&gt;10.2307/2986349&lt;/a&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Jerome H. Friedman and Werner Stuetzle (1982)&#10;&lt;em&gt;Smoothing of Scatterplots&lt;/em&gt;;&#10;Report, Dep. Statistics, Stanford U., Project Orion 003.&#10;&#10;&#10;&#10;&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;smoothEnds&lt;/code&gt; which implements Tukey&#39;s end point rule and&#10;is called by default from &lt;code&gt;runmed(*, endrule = &quot;median&quot;)&lt;/code&gt;.&#10;&lt;code&gt;smooth&lt;/code&gt; uses running&#10;medians of 3 for its compound smoothers.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;utils::example(nhtemp)&#10;myNHT &amp;lt;- as.vector(nhtemp)&#10;myNHT[20] &amp;lt;- 2 * nhtemp[20]&#10;plot(myNHT, type = &quot;b&quot;, ylim = c(48, 60), main = &quot;Running Medians Example&quot;)&#10;lines(runmed(myNHT, 7), col = &quot;red&quot;)&#10;&#10;## special: multiple y values for one x&#10;plot(cars, main = &quot;&#39;cars&#39; data and runmed(dist, 3)&quot;)&#10;lines(cars, col = &quot;light gray&quot;, type = &quot;c&quot;)&#10;with(cars, lines(speed, runmed(dist, k = 3), col = 2))&#10;&#10;&#10;## nice quadratic with a few outliers&#10;y &amp;lt;- ys &amp;lt;- (-20:20)^2&#10;y [c(1,10,21,41)] &amp;lt;- c(150, 30, 400, 450)&#10;all(y == runmed(y, 1)) # 1-neighbourhood &amp;lt;==&amp;gt; interpolation&#10;plot(y) ## lines(y, lwd = .1, col = &quot;light gray&quot;)&#10;lines(lowess(seq(y), y, f = 0.3), col = &quot;brown&quot;)&#10;lines(runmed(y, 7), lwd = 2, col = &quot;blue&quot;)&#10;lines(runmed(y, 11), lwd = 2, col = &quot;red&quot;)&#10;&#10;## Lowess is not robust&#10;y &amp;lt;- ys ; y[21] &amp;lt;- 6666 ; x &amp;lt;- seq(y)&#10;col &amp;lt;- c(&quot;black&quot;, &quot;brown&quot;,&quot;blue&quot;)&#10;plot(y, col = col[1])&#10;lines(lowess(x, y, f = 0.3), col = col[2])&#10;&#10;&#10;lines(runmed(y, 7),      lwd = 2, col = col[3])&#10;legend(length(y),max(y), c(&quot;data&quot;, &quot;lowess(y, f = 0.3)&quot;, &quot;runmed(y, 7)&quot;),&#10;       xjust = 1, col = col, lty = c(0, 1, 1), pch = c(1,NA,NA))&#10;&#10;## An example with initial NA&#39;s - used to fail badly (notably for &quot;Turlach&quot;):&#10;x15 &amp;lt;- c(rep(NA, 4), c(9, 9, 4, 22, 6, 1, 7, 5, 2, 8, 3))&#10;rS15 &amp;lt;- cbind(Sk.3 = runmed(x15, k = 3, algorithm=&quot;S&quot;),&#10;              Sk.7 = runmed(x15, k = 7, algorithm=&quot;S&quot;),&#10;              Sk.11= runmed(x15, k =11, algorithm=&quot;S&quot;))&#10;rT15 &amp;lt;- cbind(Tk.3 = runmed(x15, k = 3, algorithm=&quot;T&quot;, print.level=1),&#10;              Tk.7 = runmed(x15, k = 7, algorithm=&quot;T&quot;, print.level=1),&#10;              Tk.9 = runmed(x15, k = 9, algorithm=&quot;T&quot;, print.level=1),&#10;              Tk.11= runmed(x15, k =11, algorithm=&quot;T&quot;, print.level=1))&#10;cbind(x15, rS15, rT15) # result for k=11  maybe a bit surprising ..&#10;Tv &amp;lt;- rT15[-(1:3),]&#10;stopifnot(3 &amp;lt;= Tv, Tv &amp;lt;= 9, 5 &amp;lt;= Tv[1:10,])&#10;matplot(y = cbind(x15, rT15), type = &quot;b&quot;, ylim = c(1,9), pch=1:5, xlab = NA,&#10;        main = &quot;runmed(x15, k, algo = \\&quot;Turlach\\&quot;)&quot;)&#10;mtext(paste(&quot;x15 &amp;lt;-&quot;, deparse(x15)))&#10;points(x15, cex=2)&#10;legend(&quot;bottomleft&quot;, legend=c(&quot;data&quot;, paste(&quot;k = &quot;, c(3,7,9,11))),&#10;       bty=&quot;n&quot;, col=1:5, lty=1:5, pch=1:5)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: The Weibull Distribution&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Weibull&quot;&gt;&lt;tr&gt;&lt;td&gt;Weibull&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;The Weibull Distribution&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the Weibull distribution with parameters &lt;code&gt;shape&lt;/code&gt;&#10;and &lt;code&gt;scale&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dweibull(x, shape, scale = 1, log = FALSE)&#10;pweibull(q, shape, scale = 1, lower.tail = TRUE, log.p = FALSE)&#10;qweibull(p, shape, scale = 1, lower.tail = TRUE, log.p = FALSE)&#10;rweibull(n, shape, scale = 1)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(n) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;shape, scale&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;shape and scale parameters, the latter defaulting to 1.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;The Weibull distribution with &lt;code&gt;shape&lt;/code&gt; parameter &lt;i&gt;a&lt;/i&gt; and&#10;&lt;code&gt;scale&lt;/code&gt; parameter &lt;i&gt;b&lt;/i&gt; has density given by&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;f(x) = (a/b) (x/b)^(a-1) exp(- (x/b)^a)&lt;/i&gt;&lt;/p&gt;&#10;&lt;p&gt; for &lt;i&gt;x &amp;gt; 0&lt;/i&gt;.&#10;The cumulative distribution function is&#10;&lt;i&gt;F(x) = 1 - exp(- (x/b)^a)&lt;/i&gt;&#10;on &lt;i&gt;x &amp;gt; 0&lt;/i&gt;, the&#10;mean is &lt;i&gt;E(X) = b &amp;Gamma;(1 + 1/a)&lt;/i&gt;, and&#10;the &lt;i&gt;Var(X) = b^2 * (&amp;Gamma;(1 + 2/a) - (&amp;Gamma;(1 + 1/a))^2)&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dweibull&lt;/code&gt; gives the density,&#10;&lt;code&gt;pweibull&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qweibull&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rweibull&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;Invalid arguments will result in return value &lt;code&gt;NaN&lt;/code&gt;, with a warning.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;n&lt;/code&gt; for&#10;&lt;code&gt;rweibull&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.  &#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;n&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;The cumulative hazard &lt;i&gt;H(t) = - log(1 - F(t))&lt;/i&gt;&#10;is&#10;&lt;/p&gt;&#10;&lt;pre&gt;-pweibull(t, a, b, lower = FALSE, log = TRUE)&#10;&lt;/pre&gt;&#10;&lt;p&gt;which is just &lt;i&gt;H(t) = (t/b)^a&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;[dpq]weibull&lt;/code&gt; are calculated directly from the definitions.&#10;&lt;code&gt;rweibull&lt;/code&gt; uses inversion.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Johnson, N. L., Kotz, S. and Balakrishnan, N. (1995)&#10;&lt;em&gt;Continuous Univariate Distributions&lt;/em&gt;, volume 1, chapter 21.&#10;Wiley, New York.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;Distributions for other standard distributions, including&#10;the Exponential which is a special case of the Weibull distribution.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;x &amp;lt;- c(0, rlnorm(50))&#10;all.equal(dweibull(x, shape = 1), dexp(x))&#10;all.equal(pweibull(x, shape = 1, scale = pi), pexp(x, rate = 1/pi))&#10;## Cumulative hazard H():&#10;all.equal(pweibull(x, 2.5, pi, lower.tail = FALSE, log.p = TRUE),&#10;          -(x/pi)^2.5, tolerance = 1e-15)&#10;all.equal(qweibull(x/11, shape = 1, scale = pi), qexp(x/11, rate = 1/pi))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Distribution of the Wilcoxon Rank Sum Statistic&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for Wilcoxon&quot;&gt;&lt;tr&gt;&lt;td&gt;Wilcoxon&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Distribution of the Wilcoxon Rank Sum Statistic&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Density, distribution function, quantile function and random&#10;generation for the distribution of the Wilcoxon rank sum statistic&#10;obtained from samples with size &lt;code&gt;m&lt;/code&gt; and &lt;code&gt;n&lt;/code&gt;, respectively.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;dwilcox(x, m, n, log = FALSE)&#10;pwilcox(q, m, n, lower.tail = TRUE, log.p = FALSE)&#10;qwilcox(p, m, n, lower.tail = TRUE, log.p = FALSE)&#10;rwilcox(nn, m, n)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;x, q&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of quantiles.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;vector of probabilities.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;nn&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;number of observations. If &lt;code&gt;length(nn) &amp;gt; 1&lt;/code&gt;, the length&#10;is taken to be the number required.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;m, n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;numbers of observations in the first and second sample,&#10;respectively.  Can be vectors of positive integers.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;log, log.p&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE, probabilities p are given as log(p).&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;lower.tail&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;logical; if TRUE (default), probabilities are&#10;&lt;i&gt;P[X &amp;le; x]&lt;/i&gt;, otherwise, &lt;i&gt;P[X &amp;gt; x]&lt;/i&gt;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;This distribution is obtained as follows.  Let &lt;code&gt;x&lt;/code&gt; and &lt;code&gt;y&lt;/code&gt;&#10;be two random, independent samples of size &lt;code&gt;m&lt;/code&gt; and &lt;code&gt;n&lt;/code&gt;.&#10;Then the Wilcoxon rank sum statistic is the number of all pairs&#10;&lt;code&gt;(x[i], y[j])&lt;/code&gt; for which &lt;code&gt;y[j]&lt;/code&gt; is not greater than&#10;&lt;code&gt;x[i]&lt;/code&gt;.  This statistic takes values between &lt;code&gt;0&lt;/code&gt; and&#10;&lt;code&gt;m * n&lt;/code&gt;, and its mean and variance are &lt;code&gt;m * n / 2&lt;/code&gt; and&#10;&lt;code&gt;m * n * (m + n + 1) / 12&lt;/code&gt;, respectively.&#10;&lt;/p&gt;&#10;&lt;p&gt;If any of the first three arguments are vectors, the recycling rule is&#10;used to do the calculations for all combinations of the three up to&#10;the length of the longest vector.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;dwilcox&lt;/code&gt; gives the density,&#10;&lt;code&gt;pwilcox&lt;/code&gt; gives the distribution function,&#10;&lt;code&gt;qwilcox&lt;/code&gt; gives the quantile function, and&#10;&lt;code&gt;rwilcox&lt;/code&gt; generates random deviates.&#10;&lt;/p&gt;&#10;&lt;p&gt;The length of the result is determined by &lt;code&gt;nn&lt;/code&gt; for&#10;&lt;code&gt;rwilcox&lt;/code&gt;, and is the maximum of the lengths of the&#10;numerical arguments for the other functions.&#10;&lt;/p&gt;&#10;&lt;p&gt;The numerical arguments other than &lt;code&gt;nn&lt;/code&gt; are recycled to the&#10;length of the result.  Only the first elements of the logical&#10;arguments are used.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Warning&lt;/h3&gt;&#10;&#10;&lt;p&gt;These functions can use large amounts of memory and stack (and even crash&#10;&lt;span style=&quot;font-family: Courier New, Courier; color: #666666;&quot;&gt;&lt;b&gt;R&lt;/b&gt;&lt;/span&gt; if the stack limit is exceeded and stack-checking is not in place)&#10;if one sample is large (several thousands or more).&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Note&lt;/h3&gt;&#10;&#10;&lt;p&gt;S-PLUS uses a different (but equivalent) definition of the Wilcoxon&#10;statistic: see &lt;code&gt;wilcox.test&lt;/code&gt; for details.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Author(s)&lt;/h3&gt;&#10;&#10;&lt;p&gt;Kurt Hornik&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Source&lt;/h3&gt;&#10;&#10;&lt;p&gt;These (&amp;quot;d&amp;quot;,&amp;quot;p&amp;quot;,&amp;quot;q&amp;quot;) are calculated via recursion, based on &lt;code&gt;cwilcox(k, m, n)&lt;/code&gt;,&#10;the number of choices with statistic &lt;code&gt;k&lt;/code&gt; from samples of size&#10;&lt;code&gt;m&lt;/code&gt; and &lt;code&gt;n&lt;/code&gt;, which is itself calculated recursively and the&#10;results cached.  Then &lt;code&gt;dwilcox&lt;/code&gt; and &lt;code&gt;pwilcox&lt;/code&gt; sum&#10;appropriate values of &lt;code&gt;cwilcox&lt;/code&gt;, and &lt;code&gt;qwilcox&lt;/code&gt; is based on&#10;inversion.&#10;&lt;/p&gt;&#10;&lt;p&gt;&lt;code&gt;rwilcox&lt;/code&gt; generates a random permutation of ranks and evaluates&#10;the statistic.  Note that it is based on the same C code as &lt;code&gt;sample()&lt;/code&gt;,&#10;and hence is determined by &lt;code&gt;.Random.seed&lt;/code&gt;, notably from&#10;&lt;code&gt;RNGkind(sample.kind = ..)&lt;/code&gt; which changed with &lt;span style=&quot;font-family: Courier New, Courier; color: #666666;&quot;&gt;&lt;b&gt;R&lt;/b&gt;&lt;/span&gt; version 3.6.0.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;wilcox.test&lt;/code&gt; to calculate the statistic from data, find p&#10;values and so on.&#10;&lt;/p&gt;&#10;&lt;p&gt;Distributions for standard distributions, including&#10;&lt;code&gt;dsignrank&lt;/code&gt; for the distribution of the&#10;&lt;em&gt;one-sample&lt;/em&gt; Wilcoxon signed rank statistic.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;require(graphics)&#10;&#10;x &amp;lt;- -1:(4*6 + 1)&#10;fx &amp;lt;- dwilcox(x, 4, 6)&#10;Fx &amp;lt;- pwilcox(x, 4, 6)&#10;&#10;layout(rbind(1,2), widths = 1, heights = c(3,2))&#10;plot(x, fx, type = &quot;h&quot;, col = &quot;violet&quot;,&#10;     main =  &quot;Probabilities (density) of Wilcoxon-Statist.(n=6, m=4)&quot;)&#10;plot(x, Fx, type = &quot;s&quot;, col = &quot;blue&quot;,&#10;     main =  &quot;Distribution of Wilcoxon-Statist.(n=6, m=4)&quot;)&#10;abline(h = 0:1, col = &quot;gray20&quot;, lty = 2)&#10;layout(1) # set back&#10;&#10;N &amp;lt;- 200&#10;hist(U &amp;lt;- rwilcox(N, m = 4,n = 6), breaks = 0:25 - 1/2,&#10;     border = &quot;red&quot;, col = &quot;pink&quot;, sub = paste(&quot;N =&quot;,N))&#10;mtext(&quot;N * f(x),  f() = true \\&quot;density\\&quot;&quot;, side = 3, col = &quot;blue&quot;)&#10; lines(x, N*fx, type = &quot;h&quot;, col = &quot;blue&quot;, lwd = 2)&#10;points(x, N*fx, cex = 2)&#10;&#10;## Better is a Quantile-Quantile Plot&#10;qqplot(U, qw &amp;lt;- qwilcox((1:N - 1/2)/N, m = 4, n = 6),&#10;       main = paste(&quot;Q-Q-Plot of empirical and theoretical quantiles&quot;,&#10;                     &quot;Wilcoxon Statistic,  (m=4, n=6)&quot;, sep = &quot;\\n&quot;))&#10;n &amp;lt;- as.numeric(names(print(tU &amp;lt;- table(U))))&#10;text(n+.2, n+.5, labels = tU, col = &quot;red&quot;)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n  <div>\n    <iframe srcdoc=\"&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Strict//EN&quot; &quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd&quot;&gt;&lt;html xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;head&gt;&lt;title&gt;R: Random Wishart Distributed Matrices&lt;/title&gt;&#10;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt;&#10;&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;R.css&quot; /&gt;&#10;&lt;/head&gt;&lt;body&gt;&#10;&#10;&lt;table width=&quot;100%&quot; summary=&quot;page for rWishart&quot;&gt;&lt;tr&gt;&lt;td&gt;rWishart&lt;/td&gt;&lt;td style=&quot;text-align: right;&quot;&gt;R Documentation&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#10;&#10;&lt;h2&gt;Random Wishart Distributed Matrices&lt;/h2&gt;&#10;&#10;&lt;h3&gt;Description&lt;/h3&gt;&#10;&#10;&lt;p&gt;Generate &lt;code&gt;n&lt;/code&gt; random matrices, distributed according to the&#10;Wishart distribution with parameters &lt;code&gt;Sigma&lt;/code&gt; and &lt;code&gt;df&lt;/code&gt;,&#10;&lt;i&gt;W_p(Sigma, df)&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Usage&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;rWishart(n, df, Sigma)&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;h3&gt;Arguments&lt;/h3&gt;&#10;&#10;&lt;table summary=&quot;R argblock&quot;&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;n&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;integer sample size.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;df&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;numeric parameter, &amp;ldquo;degrees of freedom&amp;rdquo;.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;tr valign=&quot;top&quot;&gt;&lt;td&gt;&lt;code&gt;Sigma&lt;/code&gt;&lt;/td&gt;&#10;&lt;td&gt;&#10;&lt;p&gt;positive definite (&lt;i&gt;p * p&lt;/i&gt;) &amp;ldquo;scale&amp;rdquo;&#10;matrix, the matrix parameter of the distribution.&lt;/p&gt;&#10;&lt;/td&gt;&lt;/tr&gt;&#10;&lt;/table&gt;&#10;&#10;&#10;&lt;h3&gt;Details&lt;/h3&gt;&#10;&#10;&lt;p&gt;If &lt;i&gt;X1,...,Xm, Xi in R^p&lt;/i&gt; is&#10;a sample of &lt;i&gt;m&lt;/i&gt; independent multivariate Gaussians with mean (vector) 0, and&#10;covariance matrix &lt;i&gt;&amp;Sigma;&lt;/i&gt;, the distribution of&#10;&lt;i&gt;M = X&#39;X&lt;/i&gt; is &lt;i&gt;W_p(&amp;Sigma;, m)&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;Consequently, the expectation of &lt;i&gt;M&lt;/i&gt; is&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;E[M] = m * Sigma.&lt;/i&gt;&lt;/p&gt;&#10;&#10;&lt;p&gt;Further, if &lt;code&gt;Sigma&lt;/code&gt; is scalar (&lt;i&gt;p = 1&lt;/i&gt;), the Wishart&#10;distribution is a scaled chi-squared (&lt;i&gt;chi^2&lt;/i&gt;)&#10;distribution with &lt;code&gt;df&lt;/code&gt; degrees of freedom,&#10;&lt;i&gt;W_1(sigma^2, m) = sigma^2 chi[m]^2&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&lt;p&gt;The component wise variance is&#10;&lt;/p&gt;&#10;&lt;p style=&quot;text-align: center;&quot;&gt;&lt;i&gt;&#10;    Var(M[i,j]) = m*(S[i,j]^2 + S[i,i] * S[j,j]), where S=Sigma.&lt;/i&gt;&lt;/p&gt;&#10;&#10;&#10;&#10;&lt;h3&gt;Value&lt;/h3&gt;&#10;&#10;&lt;p&gt;a numeric &lt;code&gt;array&lt;/code&gt;, say &lt;code&gt;R&lt;/code&gt;, of dimension&#10;&lt;i&gt;p * p * n&lt;/i&gt;, where each &lt;code&gt;R[,,i]&lt;/code&gt; is a&#10;positive definite matrix, a realization of the Wishart distribution&#10;&lt;i&gt;W_p(Sigma, df)&lt;/i&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Author(s)&lt;/h3&gt;&#10;&#10;&lt;p&gt;Douglas Bates&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;References&lt;/h3&gt;&#10;&#10;&lt;p&gt;Mardia, K. V., J. T. Kent, and J. M. Bibby (1979)&#10;&lt;em&gt;Multivariate Analysis&lt;/em&gt;, London: Academic Press.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;See Also&lt;/h3&gt;&#10;&#10;&lt;p&gt;&lt;code&gt;cov&lt;/code&gt;, &lt;code&gt;rnorm&lt;/code&gt;, &lt;code&gt;rchisq&lt;/code&gt;.&#10;&lt;/p&gt;&#10;&#10;&#10;&lt;h3&gt;Examples&lt;/h3&gt;&#10;&#10;&lt;pre&gt;&#10;## Artificial&#10;S &amp;lt;- toeplitz((10:1)/10)&#10;set.seed(11)&#10;R &amp;lt;- rWishart(1000, 20, S)&#10;dim(R)  #  10 10  1000&#10;mR &amp;lt;- apply(R, 1:2, mean)  # ~= E[ Wish(S, 20) ] = 20 * S&#10;stopifnot(all.equal(mR, 20*S, tolerance = .009))&#10;&#10;## See Details, the variance is&#10;Va &amp;lt;- 20*(S^2 + tcrossprod(diag(S)))&#10;vR &amp;lt;- apply(R, 1:2, var)&#10;stopifnot(all.equal(vR, Va, tolerance = 1/16))&#10;&lt;/pre&gt;&#10;&#10;&#10;&lt;/body&gt;&lt;/html&gt;\" style=\"width:95%;height:400px;margin-left:auto;margin-right:auto;\"><\/iframe>\n  <\/div>\n<\/div>","divName":"baseDiv_bump_41934891557321","slideh":400,"slidew":"95%","slickOpts":{"dots":true,"slidesToShow":2,"slidesToScroll":2}}],"evals":[],"jsHooks":[]}</script>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jonathan Sidi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
